2024-01-02 21:13:26.063 | ERROR    | routes:redirect_to_cache:125 - Cannot connect to host upload-h9efy921h92:443 ssl:default [nodename nor servname provided, or not known]
Traceback (most recent call last):

  File "/opt/homebrew/lib/python3.11/site-packages/aiohttp/connector.py", line 1173, in _create_direct_connection
    hosts = await asyncio.shield(host_resolved)
                  │       │      └ <Task finished name='Task-8' coro=<TCPConnector._resolve_host() done, defined at /opt/homebrew/lib/python3.11/site-packages/a...
                  │       └ <function shield at 0x1018c59e0>
                  └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.11/3.11.6_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/as...
  File "/opt/homebrew/lib/python3.11/site-packages/aiohttp/connector.py", line 884, in _resolve_host
    addrs = await self._resolver.resolve(host, port, family=self._family)
                  │    │         │       │     │            │    └ 0
                  │    │         │       │     │            └ <aiohttp.connector.TCPConnector object at 0x103a6fb90>
                  │    │         │       │     └ 443
                  │    │         │       └ 'upload-h9efy921h92'
                  │    │         └ <function ThreadedResolver.resolve at 0x103045b20>
                  │    └ <aiohttp.resolver.ThreadedResolver object at 0x10396f150>
                  └ <aiohttp.connector.TCPConnector object at 0x103a6fb90>
  File "/opt/homebrew/lib/python3.11/site-packages/aiohttp/resolver.py", line 33, in resolve
    infos = await self._loop.getaddrinfo(
                  │    │     └ <function BaseEventLoop.getaddrinfo at 0x1018d6fc0>
                  │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
                  └ <aiohttp.resolver.ThreadedResolver object at 0x10396f150>

  File "/opt/homebrew/Cellar/python@3.11/3.11.6_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 867, in getaddrinfo
    return await self.run_in_executor(
                 │    └ <function BaseEventLoop.run_in_executor at 0x1018d6de0>
                 └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.6_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
             │        │            └ None
             │        └ None
             └ None

  File "/opt/homebrew/Cellar/python@3.11/3.11.6_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/socket.py", line 962, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
               │       │           │     │     │       │     │      └ <AddressInfo.AI_ADDRCONFIG: 1024>
               │       │           │     │     │       │     └ 0
               │       │           │     │     │       └ <SocketKind.SOCK_STREAM: 1>
               │       │           │     │     └ 0
               │       │           │     └ 443
               │       │           └ 'upload-h9efy921h92'
               │       └ <built-in function getaddrinfo>
               └ <module '_socket' from '/opt/homebrew/Cellar/python@3.11/3.11.6_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/li...

socket.gaierror: [Errno 8] nodename nor servname provided, or not known


The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "/Users/petrvolnov/work/HERE/image-cache/src/run_web.py", line 73, in <module>
    uvicorn.run(
    │       └ <function run at 0x101fd3420>
    └ <module 'uvicorn' from '/opt/homebrew/lib/python3.11/site-packages/uvicorn/__init__.py'>

  File "/opt/homebrew/lib/python3.11/site-packages/uvicorn/main.py", line 569, in run
    server.run()
    │      └ <function Server.run at 0x10203ccc0>
    └ <uvicorn.server.Server object at 0x101fd4bd0>
  File "/opt/homebrew/lib/python3.11/site-packages/uvicorn/server.py", line 60, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ None
           │       │   │    └ <function Server.serve at 0x10203cd60>
           │       │   └ <uvicorn.server.Server object at 0x101fd4bd0>
           │       └ <function run at 0x101811e40>
           └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.11/3.11.6_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/as...

  File "/opt/homebrew/Cellar/python@3.11/3.11.6_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           │      │   └ <coroutine object Server.serve at 0x10397bcd0>
           │      └ <function Runner.run at 0x1018d8900>
           └ <asyncio.runners.Runner object at 0x10396f1d0>

  File "/opt/homebrew/Cellar/python@3.11/3.11.6_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<Server.serve() running at /opt/homebrew/lib/python3.11/site-packages/uvicorn/server.py:80> ...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x1018d6520>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x10396f1d0>

  File "/opt/homebrew/Cellar/python@3.11/3.11.6_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x1018d6480>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.6_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x1018d82c0>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.6_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1922, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x101812700>
    └ <Handle Task.task_wakeup(<Future finis...r not known')>)>

  File "/opt/homebrew/Cellar/python@3.11/3.11.6_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finis...r not known')>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finis...r not known')>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finis...r not known')>)>

  File "/opt/homebrew/lib/python3.11/site-packages/uvicorn/protocols/http/h11_impl.py", line 407, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x1039b7a50>
  File "/opt/homebrew/lib/python3.11/site-packages/uvicorn/middleware/proxy_headers.py", line 78, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x103a6f7d0>>
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x103a6f7d0>>
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 7001), 'cl...
                 │    └ <fastapi.applications.FastAPI object at 0x1039ab8d0>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x1039b7a50>
  File "/opt/homebrew/lib/python3.11/site-packages/fastapi/applications.py", line 270, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x103a6f7d0>>
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x103a6f7d0>>
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 7001), 'cl...
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/applications.py", line 124, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x103a6f7d0>>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x103a6f7d0>>
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 7001), 'cl...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x1039b6950>
          └ <fastapi.applications.FastAPI object at 0x1039ab8d0>
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/errors.py", line 162, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x103739440>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x103a6f7d0>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 7001), 'cl...
          │    └ <starlette.middleware.cors.CORSMiddleware object at 0x1039b68d0>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x1039b6950>
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/cors.py", line 84, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x103739440>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x103a6f7d0>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 7001), 'cl...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x1039b6850>
          └ <starlette.middleware.cors.CORSMiddleware object at 0x1039b68d0>
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 68, in __call__
    await self.app(scope, receive, sender)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x103a52520>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x103a6f7d0>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 7001), 'cl...
          │    └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x1039b67d0>
          └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x1039b6850>
  File "/opt/homebrew/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x103a52520>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x103a6f7d0>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 7001), 'cl...
          │    └ <fastapi.routing.APIRouter object at 0x1039aba10>
          └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x1039b67d0>
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/routing.py", line 706, in __call__
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x103a52520>
          │     │      │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x103a6f7d0>>
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 7001), 'cl...
          │     └ <function Route.handle at 0x102d21800>
          └ APIRoute(path='/{path:path}', name='redirect_to_cache', methods=['GET'])
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/routing.py", line 276, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x103a52520>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x103a6f7d0>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 7001), 'cl...
          │    └ <function request_response.<locals>.app at 0x1039ad300>
          └ APIRoute(path='/{path:path}', name='redirect_to_cache', methods=['GET'])
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/routing.py", line 66, in app
    response = await func(request)
                     │    └ <starlette.requests.Request object at 0x103a6f890>
                     └ <function get_request_handler.<locals>.app at 0x1039ad4e0>
  File "/opt/homebrew/lib/python3.11/site-packages/fastapi/routing.py", line 235, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x102cf7ce0>
  File "/opt/homebrew/lib/python3.11/site-packages/fastapi/routing.py", line 161, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'path': 'upload-h9efy921h92', 'sz': None, 'r': <starlette.requests.Request object at 0x103a6f890>}
                 │         └ <function redirect_to_cache at 0x1036c3ce0>
                 └ <fastapi.dependencies.models.Dependant object at 0x1039b4f90>

> File "/Users/petrvolnov/work/HERE/image-cache/src/routes.py", line 111, in redirect_to_cache
    async with session.get(f"https://{url_path}") as response:
               │       └ <function ClientSession.get at 0x1032d0720>
               └ <aiohttp.client.ClientSession object at 0x103a6c710>

  File "/opt/homebrew/lib/python3.11/site-packages/aiohttp/client.py", line 1187, in __aenter__
    self._resp = await self._coro
    │    │             │    └ <member '_coro' of '_BaseRequestContextManager' objects>
    │    │             └ <aiohttp.client._RequestContextManager object at 0x103a74310>
    │    └ <member '_resp' of '_BaseRequestContextManager' objects>
    └ <aiohttp.client._RequestContextManager object at 0x103a74310>
  File "/opt/homebrew/lib/python3.11/site-packages/aiohttp/client.py", line 574, in _request
    conn = await self._connector.connect(
                 │    │          └ <function BaseConnector.connect at 0x1030472e0>
                 │    └ <aiohttp.connector.TCPConnector object at 0x103a6fb90>
                 └ <aiohttp.client.ClientSession object at 0x103a6c710>
  File "/opt/homebrew/lib/python3.11/site-packages/aiohttp/connector.py", line 544, in connect
    proto = await self._create_connection(req, traces, timeout)
                  │    │                  │    │       └ ClientTimeout(total=300, connect=None, sock_read=None, sock_connect=None, ceil_threshold=5)
                  │    │                  │    └ []
                  │    │                  └ <aiohttp.client_reqrep.ClientRequest object at 0x103a6fdd0>
                  │    └ <function TCPConnector._create_connection at 0x103047ec0>
                  └ <aiohttp.connector.TCPConnector object at 0x103a6fb90>
  File "/opt/homebrew/lib/python3.11/site-packages/aiohttp/connector.py", line 911, in _create_connection
    _, proto = await self._create_direct_connection(req, traces, timeout)
                     │    │                         │    │       └ ClientTimeout(total=300, connect=None, sock_read=None, sock_connect=None, ceil_threshold=5)
                     │    │                         │    └ []
                     │    │                         └ <aiohttp.client_reqrep.ClientRequest object at 0x103a6fdd0>
                     │    └ <function TCPConnector._create_direct_connection at 0x10305c5e0>
                     └ <aiohttp.connector.TCPConnector object at 0x103a6fb90>
  File "/opt/homebrew/lib/python3.11/site-packages/aiohttp/connector.py", line 1187, in _create_direct_connection
    raise ClientConnectorError(req.connection_key, exc) from exc
          │                    │   └ <property object at 0x103036840>
          │                    └ <aiohttp.client_reqrep.ClientRequest object at 0x103a6fdd0>
          └ <class 'aiohttp.client_exceptions.ClientConnectorError'>

aiohttp.client_exceptions.ClientConnectorError: Cannot connect to host upload-h9efy921h92:443 ssl:default [nodename nor servname provided, or not known]
2024-01-02 21:13:26.105 | ERROR    | routes:redirect_to_cache:126 - Cannot connect to host upload-h9efy921h92:443 ssl:default [nodename nor servname provided, or not known] upload-h9efy921h92
2024-01-02 21:14:14.658 | ERROR    | routes:redirect_to_cache:156 - Cannot connect to host upload-h9efy921h92:443 ssl:default [nodename nor servname provided, or not known]
Traceback (most recent call last):

  File "/opt/homebrew/lib/python3.11/site-packages/aiohttp/connector.py", line 1173, in _create_direct_connection
    hosts = await asyncio.shield(host_resolved)
                  │       │      └ <Task finished name='Task-8' coro=<TCPConnector._resolve_host() done, defined at /opt/homebrew/lib/python3.11/site-packages/a...
                  │       └ <function shield at 0x100ddd9e0>
                  └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.11/3.11.6_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/as...
  File "/opt/homebrew/lib/python3.11/site-packages/aiohttp/connector.py", line 884, in _resolve_host
    addrs = await self._resolver.resolve(host, port, family=self._family)
                  │    │         │       │     │            │    └ 0
                  │    │         │       │     │            └ <aiohttp.connector.TCPConnector object at 0x102f83e50>
                  │    │         │       │     └ 443
                  │    │         │       └ 'upload-h9efy921h92'
                  │    │         └ <function ThreadedResolver.resolve at 0x10255db20>
                  │    └ <aiohttp.resolver.ThreadedResolver object at 0x102ea4350>
                  └ <aiohttp.connector.TCPConnector object at 0x102f83e50>
  File "/opt/homebrew/lib/python3.11/site-packages/aiohttp/resolver.py", line 33, in resolve
    infos = await self._loop.getaddrinfo(
                  │    │     └ <function BaseEventLoop.getaddrinfo at 0x100deefc0>
                  │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
                  └ <aiohttp.resolver.ThreadedResolver object at 0x102ea4350>

  File "/opt/homebrew/Cellar/python@3.11/3.11.6_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 867, in getaddrinfo
    return await self.run_in_executor(
                 │    └ <function BaseEventLoop.run_in_executor at 0x100deede0>
                 └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.6_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
             │        │            └ None
             │        └ None
             └ None

  File "/opt/homebrew/Cellar/python@3.11/3.11.6_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/socket.py", line 962, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
               │       │           │     │     │       │     │      └ <AddressInfo.AI_ADDRCONFIG: 1024>
               │       │           │     │     │       │     └ 0
               │       │           │     │     │       └ <SocketKind.SOCK_STREAM: 1>
               │       │           │     │     └ 0
               │       │           │     └ 443
               │       │           └ 'upload-h9efy921h92'
               │       └ <built-in function getaddrinfo>
               └ <module '_socket' from '/opt/homebrew/Cellar/python@3.11/3.11.6_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/li...

socket.gaierror: [Errno 8] nodename nor servname provided, or not known


The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "/Users/petrvolnov/work/HERE/image-cache/src/run_web.py", line 73, in <module>
    uvicorn.run(
    │       └ <function run at 0x1014eb420>
    └ <module 'uvicorn' from '/opt/homebrew/lib/python3.11/site-packages/uvicorn/__init__.py'>

  File "/opt/homebrew/lib/python3.11/site-packages/uvicorn/main.py", line 569, in run
    server.run()
    │      └ <function Server.run at 0x101554cc0>
    └ <uvicorn.server.Server object at 0x1014ecbd0>
  File "/opt/homebrew/lib/python3.11/site-packages/uvicorn/server.py", line 60, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ None
           │       │   │    └ <function Server.serve at 0x101554d60>
           │       │   └ <uvicorn.server.Server object at 0x1014ecbd0>
           │       └ <function run at 0x100d29e40>
           └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.11/3.11.6_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/as...

  File "/opt/homebrew/Cellar/python@3.11/3.11.6_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           │      │   └ <coroutine object Server.serve at 0x102e8fcd0>
           │      └ <function Runner.run at 0x100df0900>
           └ <asyncio.runners.Runner object at 0x102ec1810>

  File "/opt/homebrew/Cellar/python@3.11/3.11.6_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<Server.serve() running at /opt/homebrew/lib/python3.11/site-packages/uvicorn/server.py:80> ...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x100dee520>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x102ec1810>

  File "/opt/homebrew/Cellar/python@3.11/3.11.6_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x100dee480>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.6_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x100df02c0>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.6_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1922, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x100d2a700>
    └ <Handle Task.task_wakeup(<Future finis...r not known')>)>

  File "/opt/homebrew/Cellar/python@3.11/3.11.6_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finis...r not known')>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finis...r not known')>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finis...r not known')>)>

  File "/opt/homebrew/lib/python3.11/site-packages/uvicorn/protocols/http/h11_impl.py", line 407, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x102ecfe90>
  File "/opt/homebrew/lib/python3.11/site-packages/uvicorn/middleware/proxy_headers.py", line 78, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x102f83950>>
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x102f83950>>
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 7001), 'cl...
                 │    └ <fastapi.applications.FastAPI object at 0x102ec3c90>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x102ecfe90>
  File "/opt/homebrew/lib/python3.11/site-packages/fastapi/applications.py", line 270, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x102f83950>>
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x102f83950>>
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 7001), 'cl...
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/applications.py", line 124, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x102f83950>>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x102f83950>>
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 7001), 'cl...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x102eced10>
          └ <fastapi.applications.FastAPI object at 0x102ec3c90>
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/errors.py", line 162, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x102ec5c60>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x102f83950>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 7001), 'cl...
          │    └ <starlette.middleware.cors.CORSMiddleware object at 0x102ecec90>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x102eced10>
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/cors.py", line 84, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x102ec5c60>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x102f83950>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 7001), 'cl...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x102ecec50>
          └ <starlette.middleware.cors.CORSMiddleware object at 0x102ecec90>
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 68, in __call__
    await self.app(scope, receive, sender)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x102f66a20>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x102f83950>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 7001), 'cl...
          │    └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x102ecec10>
          └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x102ecec50>
  File "/opt/homebrew/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x102f66a20>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x102f83950>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 7001), 'cl...
          │    └ <fastapi.routing.APIRouter object at 0x102ec3e10>
          └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x102ecec10>
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/routing.py", line 706, in __call__
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x102f66a20>
          │     │      │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x102f83950>>
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 7001), 'cl...
          │     └ <function Route.handle at 0x102239800>
          └ APIRoute(path='/{path:path}', name='redirect_to_cache', methods=['GET'])
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/routing.py", line 276, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x102f66a20>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x102f83950>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 7001), 'cl...
          │    └ <function request_response.<locals>.app at 0x102ec54e0>
          └ APIRoute(path='/{path:path}', name='redirect_to_cache', methods=['GET'])
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/routing.py", line 66, in app
    response = await func(request)
                     │    └ <starlette.requests.Request object at 0x102ea4190>
                     └ <function get_request_handler.<locals>.app at 0x102ec5800>
  File "/opt/homebrew/lib/python3.11/site-packages/fastapi/routing.py", line 235, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x10220fce0>
  File "/opt/homebrew/lib/python3.11/site-packages/fastapi/routing.py", line 161, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'path': 'upload-h9efy921h92/', 'sz': None, 'r': <starlette.requests.Request object at 0x102ea4190>}
                 │         └ <function redirect_to_cache at 0x102e9aac0>
                 └ <fastapi.dependencies.models.Dependant object at 0x102ece7d0>

> File "/Users/petrvolnov/work/HERE/image-cache/src/routes.py", line 142, in redirect_to_cache
    async with session.get(f"https://{url_path}") as response:
               │       └ <function ClientSession.get at 0x1027e8720>
               └ <aiohttp.client.ClientSession object at 0x102f83e10>

  File "/opt/homebrew/lib/python3.11/site-packages/aiohttp/client.py", line 1187, in __aenter__
    self._resp = await self._coro
    │    │             │    └ <member '_coro' of '_BaseRequestContextManager' objects>
    │    │             └ <aiohttp.client._RequestContextManager object at 0x102f84100>
    │    └ <member '_resp' of '_BaseRequestContextManager' objects>
    └ <aiohttp.client._RequestContextManager object at 0x102f84100>
  File "/opt/homebrew/lib/python3.11/site-packages/aiohttp/client.py", line 574, in _request
    conn = await self._connector.connect(
                 │    │          └ <function BaseConnector.connect at 0x10255f2e0>
                 │    └ <aiohttp.connector.TCPConnector object at 0x102f83e50>
                 └ <aiohttp.client.ClientSession object at 0x102f83e10>
  File "/opt/homebrew/lib/python3.11/site-packages/aiohttp/connector.py", line 544, in connect
    proto = await self._create_connection(req, traces, timeout)
                  │    │                  │    │       └ ClientTimeout(total=300, connect=None, sock_read=None, sock_connect=None, ceil_threshold=5)
                  │    │                  │    └ []
                  │    │                  └ <aiohttp.client_reqrep.ClientRequest object at 0x102f83f10>
                  │    └ <function TCPConnector._create_connection at 0x10255fec0>
                  └ <aiohttp.connector.TCPConnector object at 0x102f83e50>
  File "/opt/homebrew/lib/python3.11/site-packages/aiohttp/connector.py", line 911, in _create_connection
    _, proto = await self._create_direct_connection(req, traces, timeout)
                     │    │                         │    │       └ ClientTimeout(total=300, connect=None, sock_read=None, sock_connect=None, ceil_threshold=5)
                     │    │                         │    └ []
                     │    │                         └ <aiohttp.client_reqrep.ClientRequest object at 0x102f83f10>
                     │    └ <function TCPConnector._create_direct_connection at 0x1025745e0>
                     └ <aiohttp.connector.TCPConnector object at 0x102f83e50>
  File "/opt/homebrew/lib/python3.11/site-packages/aiohttp/connector.py", line 1187, in _create_direct_connection
    raise ClientConnectorError(req.connection_key, exc) from exc
          │                    │   └ <property object at 0x10254e7f0>
          │                    └ <aiohttp.client_reqrep.ClientRequest object at 0x102f83f10>
          └ <class 'aiohttp.client_exceptions.ClientConnectorError'>

aiohttp.client_exceptions.ClientConnectorError: Cannot connect to host upload-h9efy921h92:443 ssl:default [nodename nor servname provided, or not known]
2024-01-02 21:14:14.686 | ERROR    | routes:redirect_to_cache:157 - Cannot connect to host upload-h9efy921h92:443 ssl:default [nodename nor servname provided, or not known] upload-h9efy921h92/
2024-01-02 21:15:31.190 | ERROR    | routes:redirect_to_cache:153 - Cannot connect to host upload-h9efy921h92:443 ssl:default [nodename nor servname provided, or not known]
Traceback (most recent call last):

  File "/opt/homebrew/lib/python3.11/site-packages/aiohttp/connector.py", line 1173, in _create_direct_connection
    hosts = await asyncio.shield(host_resolved)
                  │       │      └ <Task finished name='Task-6' coro=<TCPConnector._resolve_host() done, defined at /opt/homebrew/lib/python3.11/site-packages/a...
                  │       └ <function shield at 0x1039819e0>
                  └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.11/3.11.6_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/as...
  File "/opt/homebrew/lib/python3.11/site-packages/aiohttp/connector.py", line 884, in _resolve_host
    addrs = await self._resolver.resolve(host, port, family=self._family)
                  │    │         │       │     │            │    └ 0
                  │    │         │       │     │            └ <aiohttp.connector.TCPConnector object at 0x105f93f90>
                  │    │         │       │     └ 443
                  │    │         │       └ 'upload-h9efy921h92'
                  │    │         └ <function ThreadedResolver.resolve at 0x1053ddb20>
                  │    └ <aiohttp.resolver.ThreadedResolver object at 0x105fae3d0>
                  └ <aiohttp.connector.TCPConnector object at 0x105f93f90>
  File "/opt/homebrew/lib/python3.11/site-packages/aiohttp/resolver.py", line 33, in resolve
    infos = await self._loop.getaddrinfo(
                  │    │     └ <function BaseEventLoop.getaddrinfo at 0x103992fc0>
                  │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
                  └ <aiohttp.resolver.ThreadedResolver object at 0x105fae3d0>

  File "/opt/homebrew/Cellar/python@3.11/3.11.6_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 867, in getaddrinfo
    return await self.run_in_executor(
                 │    └ <function BaseEventLoop.run_in_executor at 0x103992de0>
                 └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.6_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
             │        │            └ None
             │        └ None
             └ None

  File "/opt/homebrew/Cellar/python@3.11/3.11.6_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/socket.py", line 962, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
               │       │           │     │     │       │     │      └ <AddressInfo.AI_ADDRCONFIG: 1024>
               │       │           │     │     │       │     └ 0
               │       │           │     │     │       └ <SocketKind.SOCK_STREAM: 1>
               │       │           │     │     └ 0
               │       │           │     └ 443
               │       │           └ 'upload-h9efy921h92'
               │       └ <built-in function getaddrinfo>
               └ <module '_socket' from '/opt/homebrew/Cellar/python@3.11/3.11.6_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/li...

socket.gaierror: [Errno 8] nodename nor servname provided, or not known


The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "/Users/petrvolnov/work/HERE/image-cache/src/run_web.py", line 73, in <module>
    uvicorn.run(
    │       └ <function run at 0x10408f420>
    └ <module 'uvicorn' from '/opt/homebrew/lib/python3.11/site-packages/uvicorn/__init__.py'>

  File "/opt/homebrew/lib/python3.11/site-packages/uvicorn/main.py", line 569, in run
    server.run()
    │      └ <function Server.run at 0x1040f8cc0>
    └ <uvicorn.server.Server object at 0x104090bd0>
  File "/opt/homebrew/lib/python3.11/site-packages/uvicorn/server.py", line 60, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ None
           │       │   │    └ <function Server.serve at 0x1040f8d60>
           │       │   └ <uvicorn.server.Server object at 0x104090bd0>
           │       └ <function run at 0x1038cde40>
           └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.11/3.11.6_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/as...

  File "/opt/homebrew/Cellar/python@3.11/3.11.6_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           │      │   └ <coroutine object Server.serve at 0x105dbbcd0>
           │      └ <function Runner.run at 0x103994900>
           └ <asyncio.runners.Runner object at 0x105dfa750>

  File "/opt/homebrew/Cellar/python@3.11/3.11.6_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<Server.serve() running at /opt/homebrew/lib/python3.11/site-packages/uvicorn/server.py:80> ...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x103992520>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x105dfa750>

  File "/opt/homebrew/Cellar/python@3.11/3.11.6_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x103992480>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.6_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x1039942c0>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.6_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1922, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x1038ce700>
    └ <Handle Task.task_wakeup(<Future finis...r not known')>)>

  File "/opt/homebrew/Cellar/python@3.11/3.11.6_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finis...r not known')>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finis...r not known')>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finis...r not known')>)>

  File "/opt/homebrew/lib/python3.11/site-packages/uvicorn/protocols/http/h11_impl.py", line 407, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x105dfb4d0>
  File "/opt/homebrew/lib/python3.11/site-packages/uvicorn/middleware/proxy_headers.py", line 78, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x105faded0>>
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x105faded0>>
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 7001), 'cl...
                 │    └ <fastapi.applications.FastAPI object at 0x105def710>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x105dfb4d0>
  File "/opt/homebrew/lib/python3.11/site-packages/fastapi/applications.py", line 270, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x105faded0>>
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x105faded0>>
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 7001), 'cl...
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/applications.py", line 124, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x105faded0>>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x105faded0>>
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 7001), 'cl...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x105db3d10>
          └ <fastapi.applications.FastAPI object at 0x105def710>
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/errors.py", line 162, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x105f8e160>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x105faded0>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 7001), 'cl...
          │    └ <starlette.middleware.cors.CORSMiddleware object at 0x105dfa0d0>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x105db3d10>
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/cors.py", line 84, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x105f8e160>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x105faded0>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 7001), 'cl...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x105dfa090>
          └ <starlette.middleware.cors.CORSMiddleware object at 0x105dfa0d0>
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 68, in __call__
    await self.app(scope, receive, sender)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x105f8e200>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x105faded0>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 7001), 'cl...
          │    └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x105dfa050>
          └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x105dfa090>
  File "/opt/homebrew/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x105f8e200>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x105faded0>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 7001), 'cl...
          │    └ <fastapi.routing.APIRouter object at 0x105def8d0>
          └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x105dfa050>
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/routing.py", line 706, in __call__
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x105f8e200>
          │     │      │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x105faded0>>
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 7001), 'cl...
          │     └ <function Route.handle at 0x104ee5800>
          └ APIRoute(path='/{path:path}', name='redirect_to_cache', methods=['GET'])
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/routing.py", line 276, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x105f8e200>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x105faded0>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 7001), 'cl...
          │    └ <function request_response.<locals>.app at 0x105df1300>
          └ APIRoute(path='/{path:path}', name='redirect_to_cache', methods=['GET'])
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/routing.py", line 66, in app
    response = await func(request)
                     │    └ <starlette.requests.Request object at 0x105fae190>
                     └ <function get_request_handler.<locals>.app at 0x105df1120>
  File "/opt/homebrew/lib/python3.11/site-packages/fastapi/routing.py", line 235, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x104ebbce0>
  File "/opt/homebrew/lib/python3.11/site-packages/fastapi/routing.py", line 161, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'path': 'upload-h9efy921h92/', 'sz': None, 'r': <starlette.requests.Request object at 0x105fae190>}
                 │         └ <function redirect_to_cache at 0x105dc6840>
                 └ <fastapi.dependencies.models.Dependant object at 0x105df9bd0>

> File "/Users/petrvolnov/work/HERE/image-cache/src/routes.py", line 139, in redirect_to_cache
    async with session.get(f"https://{url_path}") as response:
               │       └ <function ClientSession.get at 0x1055f8720>
               └ <aiohttp.client.ClientSession object at 0x105fae350>

  File "/opt/homebrew/lib/python3.11/site-packages/aiohttp/client.py", line 1187, in __aenter__
    self._resp = await self._coro
    │    │             │    └ <member '_coro' of '_BaseRequestContextManager' objects>
    │    │             └ <aiohttp.client._RequestContextManager object at 0x105f66c80>
    │    └ <member '_resp' of '_BaseRequestContextManager' objects>
    └ <aiohttp.client._RequestContextManager object at 0x105f66c80>
  File "/opt/homebrew/lib/python3.11/site-packages/aiohttp/client.py", line 574, in _request
    conn = await self._connector.connect(
                 │    │          └ <function BaseConnector.connect at 0x1053df2e0>
                 │    └ <aiohttp.connector.TCPConnector object at 0x105f93f90>
                 └ <aiohttp.client.ClientSession object at 0x105fae350>
  File "/opt/homebrew/lib/python3.11/site-packages/aiohttp/connector.py", line 544, in connect
    proto = await self._create_connection(req, traces, timeout)
                  │    │                  │    │       └ ClientTimeout(total=300, connect=None, sock_read=None, sock_connect=None, ceil_threshold=5)
                  │    │                  │    └ []
                  │    │                  └ <aiohttp.client_reqrep.ClientRequest object at 0x105fae690>
                  │    └ <function TCPConnector._create_connection at 0x1053dfec0>
                  └ <aiohttp.connector.TCPConnector object at 0x105f93f90>
  File "/opt/homebrew/lib/python3.11/site-packages/aiohttp/connector.py", line 911, in _create_connection
    _, proto = await self._create_direct_connection(req, traces, timeout)
                     │    │                         │    │       └ ClientTimeout(total=300, connect=None, sock_read=None, sock_connect=None, ceil_threshold=5)
                     │    │                         │    └ []
                     │    │                         └ <aiohttp.client_reqrep.ClientRequest object at 0x105fae690>
                     │    └ <function TCPConnector._create_direct_connection at 0x1053f45e0>
                     └ <aiohttp.connector.TCPConnector object at 0x105f93f90>
  File "/opt/homebrew/lib/python3.11/site-packages/aiohttp/connector.py", line 1187, in _create_direct_connection
    raise ClientConnectorError(req.connection_key, exc) from exc
          │                    │   └ <property object at 0x1053ce610>
          │                    └ <aiohttp.client_reqrep.ClientRequest object at 0x105fae690>
          └ <class 'aiohttp.client_exceptions.ClientConnectorError'>

aiohttp.client_exceptions.ClientConnectorError: Cannot connect to host upload-h9efy921h92:443 ssl:default [nodename nor servname provided, or not known]
2024-01-02 21:15:31.216 | ERROR    | routes:redirect_to_cache:154 - Cannot connect to host upload-h9efy921h92:443 ssl:default [nodename nor servname provided, or not known] upload-h9efy921h92/
2024-01-02 21:16:14.827 | ERROR    | routes:redirect_to_cache:154 - Cannot connect to host upload-h9efy921h92:443 ssl:default [nodename nor servname provided, or not known]
Traceback (most recent call last):

  File "/opt/homebrew/lib/python3.11/site-packages/aiohttp/connector.py", line 1173, in _create_direct_connection
    hosts = await asyncio.shield(host_resolved)
                  │       │      └ <Task finished name='Task-7' coro=<TCPConnector._resolve_host() done, defined at /opt/homebrew/lib/python3.11/site-packages/a...
                  │       └ <function shield at 0x100f2d9e0>
                  └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.11/3.11.6_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/as...
  File "/opt/homebrew/lib/python3.11/site-packages/aiohttp/connector.py", line 884, in _resolve_host
    addrs = await self._resolver.resolve(host, port, family=self._family)
                  │    │         │       │     │            │    └ 0
                  │    │         │       │     │            └ <aiohttp.connector.TCPConnector object at 0x103007350>
                  │    │         │       │     └ 443
                  │    │         │       └ 'upload-h9efy921h92'
                  │    │         └ <function ThreadedResolver.resolve at 0x1026adb20>
                  │    └ <aiohttp.resolver.ThreadedResolver object at 0x102fd7c90>
                  └ <aiohttp.connector.TCPConnector object at 0x103007350>
  File "/opt/homebrew/lib/python3.11/site-packages/aiohttp/resolver.py", line 33, in resolve
    infos = await self._loop.getaddrinfo(
                  │    │     └ <function BaseEventLoop.getaddrinfo at 0x100f3efc0>
                  │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
                  └ <aiohttp.resolver.ThreadedResolver object at 0x102fd7c90>

  File "/opt/homebrew/Cellar/python@3.11/3.11.6_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 867, in getaddrinfo
    return await self.run_in_executor(
                 │    └ <function BaseEventLoop.run_in_executor at 0x100f3ede0>
                 └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.6_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
             │        │            └ None
             │        └ None
             └ None

  File "/opt/homebrew/Cellar/python@3.11/3.11.6_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/socket.py", line 962, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
               │       │           │     │     │       │     │      └ <AddressInfo.AI_ADDRCONFIG: 1024>
               │       │           │     │     │       │     └ 0
               │       │           │     │     │       └ <SocketKind.SOCK_STREAM: 1>
               │       │           │     │     └ 0
               │       │           │     └ 443
               │       │           └ 'upload-h9efy921h92'
               │       └ <built-in function getaddrinfo>
               └ <module '_socket' from '/opt/homebrew/Cellar/python@3.11/3.11.6_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/li...

socket.gaierror: [Errno 8] nodename nor servname provided, or not known


The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "/Users/petrvolnov/work/HERE/image-cache/src/run_web.py", line 73, in <module>
    uvicorn.run(
    │       └ <function run at 0x10163b420>
    └ <module 'uvicorn' from '/opt/homebrew/lib/python3.11/site-packages/uvicorn/__init__.py'>

  File "/opt/homebrew/lib/python3.11/site-packages/uvicorn/main.py", line 569, in run
    server.run()
    │      └ <function Server.run at 0x1016a4cc0>
    └ <uvicorn.server.Server object at 0x10163cbd0>
  File "/opt/homebrew/lib/python3.11/site-packages/uvicorn/server.py", line 60, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ None
           │       │   │    └ <function Server.serve at 0x1016a4d60>
           │       │   └ <uvicorn.server.Server object at 0x10163cbd0>
           │       └ <function run at 0x100e79e40>
           └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.11/3.11.6_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/as...

  File "/opt/homebrew/Cellar/python@3.11/3.11.6_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           │      │   └ <coroutine object Server.serve at 0x102fe3cd0>
           │      └ <function Runner.run at 0x100f40900>
           └ <asyncio.runners.Runner object at 0x10301e610>

  File "/opt/homebrew/Cellar/python@3.11/3.11.6_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<Server.serve() running at /opt/homebrew/lib/python3.11/site-packages/uvicorn/server.py:80> ...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x100f3e520>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x10301e610>

  File "/opt/homebrew/Cellar/python@3.11/3.11.6_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x100f3e480>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.6_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x100f402c0>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.6_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1922, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x100e7a700>
    └ <Handle Task.task_wakeup(<Future finis...r not known')>)>

  File "/opt/homebrew/Cellar/python@3.11/3.11.6_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finis...r not known')>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finis...r not known')>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finis...r not known')>)>

  File "/opt/homebrew/lib/python3.11/site-packages/uvicorn/protocols/http/h11_impl.py", line 407, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x10301f490>
  File "/opt/homebrew/lib/python3.11/site-packages/uvicorn/middleware/proxy_headers.py", line 78, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x1032ae310>>
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x1032ae310>>
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 7001), 'cl...
                 │    └ <fastapi.applications.FastAPI object at 0x103013650>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x10301f490>
  File "/opt/homebrew/lib/python3.11/site-packages/fastapi/applications.py", line 270, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x1032ae310>>
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x1032ae310>>
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 7001), 'cl...
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/applications.py", line 124, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x1032ae310>>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x1032ae310>>
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 7001), 'cl...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x10301e050>
          └ <fastapi.applications.FastAPI object at 0x103013650>
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/errors.py", line 162, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x10328e340>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x1032ae310>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 7001), 'cl...
          │    └ <starlette.middleware.cors.CORSMiddleware object at 0x10301dfd0>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x10301e050>
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/cors.py", line 84, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x10328e340>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x1032ae310>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 7001), 'cl...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x10301df90>
          └ <starlette.middleware.cors.CORSMiddleware object at 0x10301dfd0>
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 68, in __call__
    await self.app(scope, receive, sender)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x10328e3e0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x1032ae310>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 7001), 'cl...
          │    └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x10301df50>
          └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x10301df90>
  File "/opt/homebrew/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x10328e3e0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x1032ae310>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 7001), 'cl...
          │    └ <fastapi.routing.APIRouter object at 0x103013810>
          └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x10301df50>
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/routing.py", line 706, in __call__
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x10328e3e0>
          │     │      │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x1032ae310>>
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 7001), 'cl...
          │     └ <function Route.handle at 0x102389800>
          └ APIRoute(path='/{path:path}', name='redirect_to_cache', methods=['GET'])
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/routing.py", line 276, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x10328e3e0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x1032ae310>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 7001), 'cl...
          │    └ <function request_response.<locals>.app at 0x103015300>
          └ APIRoute(path='/{path:path}', name='redirect_to_cache', methods=['GET'])
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/routing.py", line 66, in app
    response = await func(request)
                     │    └ <starlette.requests.Request object at 0x1032ae6d0>
                     └ <function get_request_handler.<locals>.app at 0x103015120>
  File "/opt/homebrew/lib/python3.11/site-packages/fastapi/routing.py", line 235, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x10235fce0>
  File "/opt/homebrew/lib/python3.11/site-packages/fastapi/routing.py", line 161, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'path': 'upload-h9efy921h92/', 'sz': None, 'r': <starlette.requests.Request object at 0x1032ae6d0>}
                 │         └ <function redirect_to_cache at 0x102fea840>
                 └ <fastapi.dependencies.models.Dependant object at 0x10301db10>

> File "/Users/petrvolnov/work/HERE/image-cache/src/routes.py", line 140, in redirect_to_cache
    async with session.get(f"https://{url_path}") as response:
               │       └ <function ClientSession.get at 0x102934720>
               └ <aiohttp.client.ClientSession object at 0x1032ae810>

  File "/opt/homebrew/lib/python3.11/site-packages/aiohttp/client.py", line 1187, in __aenter__
    self._resp = await self._coro
    │    │             │    └ <member '_coro' of '_BaseRequestContextManager' objects>
    │    │             └ <aiohttp.client._RequestContextManager object at 0x103267c40>
    │    └ <member '_resp' of '_BaseRequestContextManager' objects>
    └ <aiohttp.client._RequestContextManager object at 0x103267c40>
  File "/opt/homebrew/lib/python3.11/site-packages/aiohttp/client.py", line 574, in _request
    conn = await self._connector.connect(
                 │    │          └ <function BaseConnector.connect at 0x1026af2e0>
                 │    └ <aiohttp.connector.TCPConnector object at 0x103007350>
                 └ <aiohttp.client.ClientSession object at 0x1032ae810>
  File "/opt/homebrew/lib/python3.11/site-packages/aiohttp/connector.py", line 544, in connect
    proto = await self._create_connection(req, traces, timeout)
                  │    │                  │    │       └ ClientTimeout(total=300, connect=None, sock_read=None, sock_connect=None, ceil_threshold=5)
                  │    │                  │    └ []
                  │    │                  └ <aiohttp.client_reqrep.ClientRequest object at 0x1032ae9d0>
                  │    └ <function TCPConnector._create_connection at 0x1026afec0>
                  └ <aiohttp.connector.TCPConnector object at 0x103007350>
  File "/opt/homebrew/lib/python3.11/site-packages/aiohttp/connector.py", line 911, in _create_connection
    _, proto = await self._create_direct_connection(req, traces, timeout)
                     │    │                         │    │       └ ClientTimeout(total=300, connect=None, sock_read=None, sock_connect=None, ceil_threshold=5)
                     │    │                         │    └ []
                     │    │                         └ <aiohttp.client_reqrep.ClientRequest object at 0x1032ae9d0>
                     │    └ <function TCPConnector._create_direct_connection at 0x1026c45e0>
                     └ <aiohttp.connector.TCPConnector object at 0x103007350>
  File "/opt/homebrew/lib/python3.11/site-packages/aiohttp/connector.py", line 1187, in _create_direct_connection
    raise ClientConnectorError(req.connection_key, exc) from exc
          │                    │   └ <property object at 0x1026a27a0>
          │                    └ <aiohttp.client_reqrep.ClientRequest object at 0x1032ae9d0>
          └ <class 'aiohttp.client_exceptions.ClientConnectorError'>

aiohttp.client_exceptions.ClientConnectorError: Cannot connect to host upload-h9efy921h92:443 ssl:default [nodename nor servname provided, or not known]
2024-01-02 21:16:14.851 | ERROR    | routes:redirect_to_cache:155 - Cannot connect to host upload-h9efy921h92:443 ssl:default [nodename nor servname provided, or not known] upload-h9efy921h92/
2024-01-02 21:20:04.586 | ERROR    | routes:redirect_to_cache:154 - Cannot connect to host upload-h9efy921h92:443 ssl:default [nodename nor servname provided, or not known]
Traceback (most recent call last):

  File "/Users/petrvolnov/work/HERE/image-cache/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1173, in _create_direct_connection
    hosts = await asyncio.shield(host_resolved)
                  │       │      └ <Task finished name='Task-6' coro=<TCPConnector._resolve_host() done, defined at /Users/petrvolnov/work/HERE/image-cache/venv...
                  │       └ <function shield at 0x101524fe0>
                  └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.11/3.11.6_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/as...
  File "/Users/petrvolnov/work/HERE/image-cache/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 884, in _resolve_host
    addrs = await self._resolver.resolve(host, port, family=self._family)
                  │    │         │       │     │            │    └ 0
                  │    │         │       │     │            └ <aiohttp.connector.TCPConnector object at 0x1038290d0>
                  │    │         │       │     └ 443
                  │    │         │       └ 'upload-h9efy921h92'
                  │    │         └ <function ThreadedResolver.resolve at 0x102f3eac0>
                  │    └ <aiohttp.resolver.ThreadedResolver object at 0x10383f610>
                  └ <aiohttp.connector.TCPConnector object at 0x1038290d0>
  File "/Users/petrvolnov/work/HERE/image-cache/venv/lib/python3.11/site-packages/aiohttp/resolver.py", line 33, in resolve
    infos = await self._loop.getaddrinfo(
                  │    │     └ <function BaseEventLoop.getaddrinfo at 0x1015325c0>
                  │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
                  └ <aiohttp.resolver.ThreadedResolver object at 0x10383f610>

  File "/opt/homebrew/Cellar/python@3.11/3.11.6_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 867, in getaddrinfo
    return await self.run_in_executor(
                 │    └ <function BaseEventLoop.run_in_executor at 0x1015323e0>
                 └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.6_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
             │        │            └ None
             │        └ None
             └ None

  File "/opt/homebrew/Cellar/python@3.11/3.11.6_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/socket.py", line 962, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
               │       │           │     │     │       │     │      └ <AddressInfo.AI_ADDRCONFIG: 1024>
               │       │           │     │     │       │     └ 0
               │       │           │     │     │       └ <SocketKind.SOCK_STREAM: 1>
               │       │           │     │     └ 0
               │       │           │     └ 443
               │       │           └ 'upload-h9efy921h92'
               │       └ <built-in function getaddrinfo>
               └ <module '_socket' from '/opt/homebrew/Cellar/python@3.11/3.11.6_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/li...

socket.gaierror: [Errno 8] nodename nor servname provided, or not known


The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "/Users/petrvolnov/work/HERE/image-cache/src/run_web.py", line 73, in <module>
    uvicorn.run(
    │       └ <function run at 0x101796200>
    └ <module 'uvicorn' from '/Users/petrvolnov/work/HERE/image-cache/venv/lib/python3.11/site-packages/uvicorn/__init__.py'>

  File "/Users/petrvolnov/work/HERE/image-cache/venv/lib/python3.11/site-packages/uvicorn/main.py", line 587, in run
    server.run()
    │      └ <function Server.run at 0x1017d7920>
    └ <uvicorn.server.Server object at 0x103ad3810>
  File "/Users/petrvolnov/work/HERE/image-cache/venv/lib/python3.11/site-packages/uvicorn/server.py", line 61, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ None
           │       │   │    └ <function Server.serve at 0x1017d79c0>
           │       │   └ <uvicorn.server.Server object at 0x103ad3810>
           │       └ <function run at 0x1014d4540>
           └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.11/3.11.6_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/as...

  File "/opt/homebrew/Cellar/python@3.11/3.11.6_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           │      │   └ <coroutine object Server.serve at 0x103c7f450>
           │      └ <function Runner.run at 0x101533ec0>
           └ <asyncio.runners.Runner object at 0x103cb3f50>

  File "/opt/homebrew/Cellar/python@3.11/3.11.6_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<Server.serve() running at /Users/petrvolnov/work/HERE/image-cache/venv/lib/python3.11/site-...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x101531b20>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x103cb3f50>

  File "/opt/homebrew/Cellar/python@3.11/3.11.6_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x101531a80>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.6_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x101533880>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.6_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1922, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x101471d00>
    └ <Handle Task.task_wakeup(<Future finis...r not known')>)>

  File "/opt/homebrew/Cellar/python@3.11/3.11.6_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finis...r not known')>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finis...r not known')>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finis...r not known')>)>

  File "/Users/petrvolnov/work/HERE/image-cache/venv/lib/python3.11/site-packages/uvicorn/protocols/http/h11_impl.py", line 408, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x103c89210>
  File "/Users/petrvolnov/work/HERE/image-cache/venv/lib/python3.11/site-packages/uvicorn/middleware/proxy_headers.py", line 84, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x103d0a590>>
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x103d0a590>>
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 7001), 'cl...
                 │    └ <fastapi.applications.FastAPI object at 0x103cb0e50>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x103c89210>
  File "/Users/petrvolnov/work/HERE/image-cache/venv/lib/python3.11/site-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x103d0a590>>
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x103d0a590>>
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 7001), 'cl...
  File "/Users/petrvolnov/work/HERE/image-cache/venv/lib/python3.11/site-packages/starlette/applications.py", line 116, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x103d0a590>>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x103d0a590>>
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 7001), 'cl...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x103ad1010>
          └ <fastapi.applications.FastAPI object at 0x103cb0e50>
  File "/Users/petrvolnov/work/HERE/image-cache/venv/lib/python3.11/site-packages/starlette/middleware/errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x103d15080>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x103d0a590>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 7001), 'cl...
          │    └ <starlette.middleware.cors.CORSMiddleware object at 0x103848290>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x103ad1010>
  File "/Users/petrvolnov/work/HERE/image-cache/venv/lib/python3.11/site-packages/starlette/middleware/cors.py", line 83, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x103d15080>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x103d0a590>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 7001), 'cl...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x103c89c10>
          └ <starlette.middleware.cors.CORSMiddleware object at 0x103848290>
  File "/Users/petrvolnov/work/HERE/image-cache/venv/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
          │                            │    │    │     │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x103d15080>
          │                            │    │    │     │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x103d0a590>>
          │                            │    │    │     └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 7001), 'cl...
          │                            │    │    └ <starlette.requests.Request object at 0x103c8a890>
          │                            │    └ <fastapi.routing.APIRouter object at 0x103cb0f90>
          │                            └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x103c89c10>
          └ <function wrap_app_handling_exceptions at 0x1029c7060>
  File "/Users/petrvolnov/work/HERE/image-cache/venv/lib/python3.11/site-packages/starlette/_exception_handler.py", line 44, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x103d151c0>
          │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x103d0a590>>
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 7001), 'cl...
          └ <fastapi.routing.APIRouter object at 0x103cb0f90>
  File "/Users/petrvolnov/work/HERE/image-cache/venv/lib/python3.11/site-packages/starlette/routing.py", line 746, in __call__
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x103d151c0>
          │     │      │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x103d0a590>>
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 7001), 'cl...
          │     └ <function Route.handle at 0x1029ec720>
          └ APIRoute(path='/{path:path}', name='redirect_to_cache', methods=['GET'])
  File "/Users/petrvolnov/work/HERE/image-cache/venv/lib/python3.11/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x103d151c0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x103d0a590>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 7001), 'cl...
          │    └ <function request_response.<locals>.app at 0x103cb94e0>
          └ APIRoute(path='/{path:path}', name='redirect_to_cache', methods=['GET'])
  File "/Users/petrvolnov/work/HERE/image-cache/venv/lib/python3.11/site-packages/starlette/routing.py", line 75, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
          │                            │    │        │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x103d151c0>
          │                            │    │        │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x103d0a590>>
          │                            │    │        └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 7001), 'cl...
          │                            │    └ <starlette.requests.Request object at 0x103828e90>
          │                            └ <function request_response.<locals>.app.<locals>.app at 0x103d15260>
          └ <function wrap_app_handling_exceptions at 0x1029c7060>
  File "/Users/petrvolnov/work/HERE/image-cache/venv/lib/python3.11/site-packages/starlette/_exception_handler.py", line 44, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x103d153a0>
          │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x103d0a590>>
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 7001), 'cl...
          └ <function request_response.<locals>.app.<locals>.app at 0x103d15260>
  File "/Users/petrvolnov/work/HERE/image-cache/venv/lib/python3.11/site-packages/starlette/routing.py", line 70, in app
    response = await func(request)
                     │    └ <starlette.requests.Request object at 0x103828e90>
                     └ <function get_request_handler.<locals>.app at 0x103cb9440>
  File "/Users/petrvolnov/work/HERE/image-cache/venv/lib/python3.11/site-packages/fastapi/routing.py", line 294, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x1029c6700>
  File "/Users/petrvolnov/work/HERE/image-cache/venv/lib/python3.11/site-packages/fastapi/routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'path': 'upload-h9efy921h92/', 'sz': None, 'r': <starlette.requests.Request object at 0x103828e90>}
                 │         └ <function redirect_to_cache at 0x103c79a80>
                 └ <fastapi.dependencies.models.Dependant object at 0x103cb3ed0>

> File "/Users/petrvolnov/work/HERE/image-cache/src/routes.py", line 140, in redirect_to_cache
    async with session.get(f"https://{url_path}") as response:
               │       └ <function ClientSession.get at 0x10302d800>
               └ <aiohttp.client.ClientSession object at 0x103b9b450>

  File "/Users/petrvolnov/work/HERE/image-cache/venv/lib/python3.11/site-packages/aiohttp/client.py", line 1187, in __aenter__
    self._resp = await self._coro
    │    │             │    └ <member '_coro' of '_BaseRequestContextManager' objects>
    │    │             └ <aiohttp.client._RequestContextManager object at 0x103d02230>
    │    └ <member '_resp' of '_BaseRequestContextManager' objects>
    └ <aiohttp.client._RequestContextManager object at 0x103d02230>
  File "/Users/petrvolnov/work/HERE/image-cache/venv/lib/python3.11/site-packages/aiohttp/client.py", line 574, in _request
    conn = await self._connector.connect(
                 │    │          └ <function BaseConnector.connect at 0x102f5c2c0>
                 │    └ <aiohttp.connector.TCPConnector object at 0x1038290d0>
                 └ <aiohttp.client.ClientSession object at 0x103b9b450>
  File "/Users/petrvolnov/work/HERE/image-cache/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 544, in connect
    proto = await self._create_connection(req, traces, timeout)
                  │    │                  │    │       └ ClientTimeout(total=300, connect=None, sock_read=None, sock_connect=None, ceil_threshold=5)
                  │    │                  │    └ []
                  │    │                  └ <aiohttp.client_reqrep.ClientRequest object at 0x103ac8a50>
                  │    └ <function TCPConnector._create_connection at 0x102f5cea0>
                  └ <aiohttp.connector.TCPConnector object at 0x1038290d0>
  File "/Users/petrvolnov/work/HERE/image-cache/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 911, in _create_connection
    _, proto = await self._create_direct_connection(req, traces, timeout)
                     │    │                         │    │       └ ClientTimeout(total=300, connect=None, sock_read=None, sock_connect=None, ceil_threshold=5)
                     │    │                         │    └ []
                     │    │                         └ <aiohttp.client_reqrep.ClientRequest object at 0x103ac8a50>
                     │    └ <function TCPConnector._create_direct_connection at 0x102f5d580>
                     └ <aiohttp.connector.TCPConnector object at 0x1038290d0>
  File "/Users/petrvolnov/work/HERE/image-cache/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1187, in _create_direct_connection
    raise ClientConnectorError(req.connection_key, exc) from exc
          │                    │   └ <property object at 0x102f39120>
          │                    └ <aiohttp.client_reqrep.ClientRequest object at 0x103ac8a50>
          └ <class 'aiohttp.client_exceptions.ClientConnectorError'>

aiohttp.client_exceptions.ClientConnectorError: Cannot connect to host upload-h9efy921h92:443 ssl:default [nodename nor servname provided, or not known]
2024-01-02 21:20:04.681 | ERROR    | routes:redirect_to_cache:155 - Cannot connect to host upload-h9efy921h92:443 ssl:default [nodename nor servname provided, or not known] upload-h9efy921h92/
2024-01-02 21:20:49.065 | ERROR    | routes:redirect_to_cache:153 - Cannot connect to host favicon.ico:443 ssl:default [nodename nor servname provided, or not known]
Traceback (most recent call last):

  File "/Users/petrvolnov/work/HERE/image-cache/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1173, in _create_direct_connection
    hosts = await asyncio.shield(host_resolved)
                  │       │      └ <Task finished name='Task-9' coro=<TCPConnector._resolve_host() done, defined at /Users/petrvolnov/work/HERE/image-cache/venv...
                  │       └ <function shield at 0x101ac4fe0>
                  └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.11/3.11.6_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/as...
  File "/Users/petrvolnov/work/HERE/image-cache/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 884, in _resolve_host
    addrs = await self._resolver.resolve(host, port, family=self._family)
                  │    │         │       │     │            │    └ 0
                  │    │         │       │     │            └ <aiohttp.connector.TCPConnector object at 0x10532a310>
                  │    │         │       │     └ 443
                  │    │         │       └ 'favicon.ico'
                  │    │         └ <function ThreadedResolver.resolve at 0x1047b2ac0>
                  │    └ <aiohttp.resolver.ThreadedResolver object at 0x1056d68d0>
                  └ <aiohttp.connector.TCPConnector object at 0x10532a310>
  File "/Users/petrvolnov/work/HERE/image-cache/venv/lib/python3.11/site-packages/aiohttp/resolver.py", line 33, in resolve
    infos = await self._loop.getaddrinfo(
                  │    │     └ <function BaseEventLoop.getaddrinfo at 0x101ad25c0>
                  │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
                  └ <aiohttp.resolver.ThreadedResolver object at 0x1056d68d0>

  File "/opt/homebrew/Cellar/python@3.11/3.11.6_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 867, in getaddrinfo
    return await self.run_in_executor(
                 │    └ <function BaseEventLoop.run_in_executor at 0x101ad23e0>
                 └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.6_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
             │        │            └ None
             │        └ None
             └ None

  File "/opt/homebrew/Cellar/python@3.11/3.11.6_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/socket.py", line 962, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
               │       │           │     │     │       │     │      └ <AddressInfo.AI_ADDRCONFIG: 1024>
               │       │           │     │     │       │     └ 0
               │       │           │     │     │       └ <SocketKind.SOCK_STREAM: 1>
               │       │           │     │     └ 0
               │       │           │     └ 443
               │       │           └ 'favicon.ico'
               │       └ <built-in function getaddrinfo>
               └ <module '_socket' from '/opt/homebrew/Cellar/python@3.11/3.11.6_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/li...

socket.gaierror: [Errno 8] nodename nor servname provided, or not known


The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "/Users/petrvolnov/work/HERE/image-cache/src/run_web.py", line 73, in <module>
    uvicorn.run(
    │       └ <function run at 0x101d36200>
    └ <module 'uvicorn' from '/Users/petrvolnov/work/HERE/image-cache/venv/lib/python3.11/site-packages/uvicorn/__init__.py'>

  File "/Users/petrvolnov/work/HERE/image-cache/venv/lib/python3.11/site-packages/uvicorn/main.py", line 587, in run
    server.run()
    │      └ <function Server.run at 0x101d77920>
    └ <uvicorn.server.Server object at 0x1058971d0>
  File "/Users/petrvolnov/work/HERE/image-cache/venv/lib/python3.11/site-packages/uvicorn/server.py", line 61, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ None
           │       │   │    └ <function Server.serve at 0x101d779c0>
           │       │   └ <uvicorn.server.Server object at 0x1058971d0>
           │       └ <function run at 0x101a74540>
           └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.11/3.11.6_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/as...

  File "/opt/homebrew/Cellar/python@3.11/3.11.6_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           │      │   └ <coroutine object Server.serve at 0x10589f450>
           │      └ <function Runner.run at 0x101ad3ec0>
           └ <asyncio.runners.Runner object at 0x105267090>

  File "/opt/homebrew/Cellar/python@3.11/3.11.6_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<Server.serve() running at /Users/petrvolnov/work/HERE/image-cache/venv/lib/python3.11/site-...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x101ad1b20>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x105267090>

  File "/opt/homebrew/Cellar/python@3.11/3.11.6_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x101ad1a80>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.6_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x101ad3880>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.6_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1922, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x101a11d00>
    └ <Handle Task.task_wakeup(<Future finis...r not known')>)>

  File "/opt/homebrew/Cellar/python@3.11/3.11.6_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finis...r not known')>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finis...r not known')>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finis...r not known')>)>

  File "/Users/petrvolnov/work/HERE/image-cache/venv/lib/python3.11/site-packages/uvicorn/protocols/http/h11_impl.py", line 408, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x1058c33d0>
  File "/Users/petrvolnov/work/HERE/image-cache/venv/lib/python3.11/site-packages/uvicorn/middleware/proxy_headers.py", line 84, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x105927050>>
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x105927050>>
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 7001), 'cl...
                 │    └ <fastapi.applications.FastAPI object at 0x1058cd6d0>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x1058c33d0>
  File "/Users/petrvolnov/work/HERE/image-cache/venv/lib/python3.11/site-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x105927050>>
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x105927050>>
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 7001), 'cl...
  File "/Users/petrvolnov/work/HERE/image-cache/venv/lib/python3.11/site-packages/starlette/applications.py", line 116, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x105927050>>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x105927050>>
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 7001), 'cl...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x1058966d0>
          └ <fastapi.applications.FastAPI object at 0x1058cd6d0>
  File "/Users/petrvolnov/work/HERE/image-cache/venv/lib/python3.11/site-packages/starlette/middleware/errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x105930fe0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x105927050>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 7001), 'cl...
          │    └ <starlette.middleware.cors.CORSMiddleware object at 0x105329590>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x1058966d0>
  File "/Users/petrvolnov/work/HERE/image-cache/venv/lib/python3.11/site-packages/starlette/middleware/cors.py", line 83, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x105930fe0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x105927050>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 7001), 'cl...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x105358e10>
          └ <starlette.middleware.cors.CORSMiddleware object at 0x105329590>
  File "/Users/petrvolnov/work/HERE/image-cache/venv/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
          │                            │    │    │     │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x105930fe0>
          │                            │    │    │     │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x105927050>>
          │                            │    │    │     └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 7001), 'cl...
          │                            │    │    └ <starlette.requests.Request object at 0x105926f50>
          │                            │    └ <fastapi.routing.APIRouter object at 0x1058cd810>
          │                            └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x105358e10>
          └ <function wrap_app_handling_exceptions at 0x10438f060>
  File "/Users/petrvolnov/work/HERE/image-cache/venv/lib/python3.11/site-packages/starlette/_exception_handler.py", line 44, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x105931120>
          │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x105927050>>
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 7001), 'cl...
          └ <fastapi.routing.APIRouter object at 0x1058cd810>
  File "/Users/petrvolnov/work/HERE/image-cache/venv/lib/python3.11/site-packages/starlette/routing.py", line 746, in __call__
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x105931120>
          │     │      │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x105927050>>
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 7001), 'cl...
          │     └ <function Route.handle at 0x1043b4720>
          └ APIRoute(path='/{path:path}', name='redirect_to_cache', methods=['GET'])
  File "/Users/petrvolnov/work/HERE/image-cache/venv/lib/python3.11/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x105931120>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x105927050>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 7001), 'cl...
          │    └ <function request_response.<locals>.app at 0x1058d54e0>
          └ APIRoute(path='/{path:path}', name='redirect_to_cache', methods=['GET'])
  File "/Users/petrvolnov/work/HERE/image-cache/venv/lib/python3.11/site-packages/starlette/routing.py", line 75, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
          │                            │    │        │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x105931120>
          │                            │    │        │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x105927050>>
          │                            │    │        └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 7001), 'cl...
          │                            │    └ <starlette.requests.Request object at 0x105927010>
          │                            └ <function request_response.<locals>.app.<locals>.app at 0x105931080>
          └ <function wrap_app_handling_exceptions at 0x10438f060>
  File "/Users/petrvolnov/work/HERE/image-cache/venv/lib/python3.11/site-packages/starlette/_exception_handler.py", line 44, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x105931260>
          │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x105927050>>
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 7001), 'cl...
          └ <function request_response.<locals>.app.<locals>.app at 0x105931080>
  File "/Users/petrvolnov/work/HERE/image-cache/venv/lib/python3.11/site-packages/starlette/routing.py", line 70, in app
    response = await func(request)
                     │    └ <starlette.requests.Request object at 0x105927010>
                     └ <function get_request_handler.<locals>.app at 0x1058d5440>
  File "/Users/petrvolnov/work/HERE/image-cache/venv/lib/python3.11/site-packages/fastapi/routing.py", line 294, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x10438e700>
  File "/Users/petrvolnov/work/HERE/image-cache/venv/lib/python3.11/site-packages/fastapi/routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'path': 'favicon.ico', 'sz': None, 'r': <starlette.requests.Request object at 0x105927010>}
                 │         └ <function redirect_to_cache at 0x105899a80>
                 └ <fastapi.dependencies.models.Dependant object at 0x1058d8910>

> File "/Users/petrvolnov/work/HERE/image-cache/src/routes.py", line 139, in redirect_to_cache
    async with session.get(f"https://{url_path}") as response:
               │       └ <function ClientSession.get at 0x1049dd800>
               └ <aiohttp.client.ClientSession object at 0x105895c90>

  File "/Users/petrvolnov/work/HERE/image-cache/venv/lib/python3.11/site-packages/aiohttp/client.py", line 1187, in __aenter__
    self._resp = await self._coro
    │    │             │    └ <member '_coro' of '_BaseRequestContextManager' objects>
    │    │             └ <aiohttp.client._RequestContextManager object at 0x10591e320>
    │    └ <member '_resp' of '_BaseRequestContextManager' objects>
    └ <aiohttp.client._RequestContextManager object at 0x10591e320>
  File "/Users/petrvolnov/work/HERE/image-cache/venv/lib/python3.11/site-packages/aiohttp/client.py", line 574, in _request
    conn = await self._connector.connect(
                 │    │          └ <function BaseConnector.connect at 0x1047d82c0>
                 │    └ <aiohttp.connector.TCPConnector object at 0x10532a310>
                 └ <aiohttp.client.ClientSession object at 0x105895c90>
  File "/Users/petrvolnov/work/HERE/image-cache/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 544, in connect
    proto = await self._create_connection(req, traces, timeout)
                  │    │                  │    │       └ ClientTimeout(total=300, connect=None, sock_read=None, sock_connect=None, ceil_threshold=5)
                  │    │                  │    └ []
                  │    │                  └ <aiohttp.client_reqrep.ClientRequest object at 0x1056d7410>
                  │    └ <function TCPConnector._create_connection at 0x1047d8ea0>
                  └ <aiohttp.connector.TCPConnector object at 0x10532a310>
  File "/Users/petrvolnov/work/HERE/image-cache/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 911, in _create_connection
    _, proto = await self._create_direct_connection(req, traces, timeout)
                     │    │                         │    │       └ ClientTimeout(total=300, connect=None, sock_read=None, sock_connect=None, ceil_threshold=5)
                     │    │                         │    └ []
                     │    │                         └ <aiohttp.client_reqrep.ClientRequest object at 0x1056d7410>
                     │    └ <function TCPConnector._create_direct_connection at 0x1047d9580>
                     └ <aiohttp.connector.TCPConnector object at 0x10532a310>
  File "/Users/petrvolnov/work/HERE/image-cache/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1187, in _create_direct_connection
    raise ClientConnectorError(req.connection_key, exc) from exc
          │                    │   └ <property object at 0x1047ad030>
          │                    └ <aiohttp.client_reqrep.ClientRequest object at 0x1056d7410>
          └ <class 'aiohttp.client_exceptions.ClientConnectorError'>

aiohttp.client_exceptions.ClientConnectorError: Cannot connect to host favicon.ico:443 ssl:default [nodename nor servname provided, or not known]
2024-01-02 21:20:49.201 | ERROR    | routes:redirect_to_cache:154 - Cannot connect to host favicon.ico:443 ssl:default [nodename nor servname provided, or not known] favicon.ico
2024-01-02 21:24:31.902 | ERROR    | routes:redirect_to_cache:152 - Cannot connect to host favicon.ico:443 ssl:default [nodename nor servname provided, or not known]
Traceback (most recent call last):

  File "/Users/petrvolnov/work/HERE/image-cache/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1173, in _create_direct_connection
    hosts = await asyncio.shield(host_resolved)
                  │       │      └ <Task finished name='Task-9' coro=<TCPConnector._resolve_host() done, defined at /Users/petrvolnov/work/HERE/image-cache/venv...
                  │       └ <function shield at 0x1057a4fe0>
                  └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.11/3.11.6_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/as...
  File "/Users/petrvolnov/work/HERE/image-cache/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 884, in _resolve_host
    addrs = await self._resolver.resolve(host, port, family=self._family)
                  │    │         │       │     │            │    └ 0
                  │    │         │       │     │            └ <aiohttp.connector.TCPConnector object at 0x111631310>
                  │    │         │       │     └ 443
                  │    │         │       └ 'favicon.ico'
                  │    │         └ <function ThreadedResolver.resolve at 0x1071baac0>
                  │    └ <aiohttp.resolver.ThreadedResolver object at 0x111631390>
                  └ <aiohttp.connector.TCPConnector object at 0x111631310>
  File "/Users/petrvolnov/work/HERE/image-cache/venv/lib/python3.11/site-packages/aiohttp/resolver.py", line 33, in resolve
    infos = await self._loop.getaddrinfo(
                  │    │     └ <function BaseEventLoop.getaddrinfo at 0x1057b25c0>
                  │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
                  └ <aiohttp.resolver.ThreadedResolver object at 0x111631390>

  File "/opt/homebrew/Cellar/python@3.11/3.11.6_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 867, in getaddrinfo
    return await self.run_in_executor(
                 │    └ <function BaseEventLoop.run_in_executor at 0x1057b23e0>
                 └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.6_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
             │        │            └ None
             │        └ None
             └ None

  File "/opt/homebrew/Cellar/python@3.11/3.11.6_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/socket.py", line 962, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
               │       │           │     │     │       │     │      └ <AddressInfo.AI_ADDRCONFIG: 1024>
               │       │           │     │     │       │     └ 0
               │       │           │     │     │       └ <SocketKind.SOCK_STREAM: 1>
               │       │           │     │     └ 0
               │       │           │     └ 443
               │       │           └ 'favicon.ico'
               │       └ <built-in function getaddrinfo>
               └ <module '_socket' from '/opt/homebrew/Cellar/python@3.11/3.11.6_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/li...

socket.gaierror: [Errno 8] nodename nor servname provided, or not known


The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "/Users/petrvolnov/work/HERE/image-cache/src/run_web.py", line 73, in <module>
    uvicorn.run(
    │       └ <function run at 0x105a16200>
    └ <module 'uvicorn' from '/Users/petrvolnov/work/HERE/image-cache/venv/lib/python3.11/site-packages/uvicorn/__init__.py'>

  File "/Users/petrvolnov/work/HERE/image-cache/venv/lib/python3.11/site-packages/uvicorn/main.py", line 587, in run
    server.run()
    │      └ <function Server.run at 0x105a57920>
    └ <uvicorn.server.Server object at 0x1059f2b90>
  File "/Users/petrvolnov/work/HERE/image-cache/venv/lib/python3.11/site-packages/uvicorn/server.py", line 61, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ None
           │       │   │    └ <function Server.serve at 0x105a579c0>
           │       │   └ <uvicorn.server.Server object at 0x1059f2b90>
           │       └ <function run at 0x105754540>
           └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.11/3.11.6_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/as...

  File "/opt/homebrew/Cellar/python@3.11/3.11.6_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           │      │   └ <coroutine object Server.serve at 0x11149f340>
           │      └ <function Runner.run at 0x1057b3ec0>
           └ <asyncio.runners.Runner object at 0x1112ec350>

  File "/opt/homebrew/Cellar/python@3.11/3.11.6_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<Server.serve() running at /Users/petrvolnov/work/HERE/image-cache/venv/lib/python3.11/site-...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x1057b1b20>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x1112ec350>

  File "/opt/homebrew/Cellar/python@3.11/3.11.6_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x1057b1a80>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.6_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x1057b3880>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.6_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1922, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x1056f1d00>
    └ <Handle Task.task_wakeup(<Future finis...r not known')>)>

  File "/opt/homebrew/Cellar/python@3.11/3.11.6_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finis...r not known')>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finis...r not known')>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finis...r not known')>)>

  File "/Users/petrvolnov/work/HERE/image-cache/venv/lib/python3.11/site-packages/uvicorn/protocols/http/h11_impl.py", line 408, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x1114cb950>
  File "/Users/petrvolnov/work/HERE/image-cache/venv/lib/python3.11/site-packages/uvicorn/middleware/proxy_headers.py", line 84, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x111630f10>>
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x111630f10>>
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 7001), 'cl...
                 │    └ <fastapi.applications.FastAPI object at 0x1114c82d0>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x1114cb950>
  File "/Users/petrvolnov/work/HERE/image-cache/venv/lib/python3.11/site-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x111630f10>>
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x111630f10>>
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 7001), 'cl...
  File "/Users/petrvolnov/work/HERE/image-cache/venv/lib/python3.11/site-packages/starlette/applications.py", line 116, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x111630f10>>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x111630f10>>
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 7001), 'cl...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x111038490>
          └ <fastapi.applications.FastAPI object at 0x1114c82d0>
  File "/Users/petrvolnov/work/HERE/image-cache/venv/lib/python3.11/site-packages/starlette/middleware/errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x1114d0040>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x111630f10>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 7001), 'cl...
          │    └ <starlette.middleware.cors.CORSMiddleware object at 0x106476790>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x111038490>
  File "/Users/petrvolnov/work/HERE/image-cache/venv/lib/python3.11/site-packages/starlette/middleware/cors.py", line 83, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x1114d0040>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x111630f10>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 7001), 'cl...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x111049e90>
          └ <starlette.middleware.cors.CORSMiddleware object at 0x106476790>
  File "/Users/petrvolnov/work/HERE/image-cache/venv/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
          │                            │    │    │     │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x1114d0040>
          │                            │    │    │     │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x111630f10>>
          │                            │    │    │     └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 7001), 'cl...
          │                            │    │    └ <starlette.requests.Request object at 0x111630b10>
          │                            │    └ <fastapi.routing.APIRouter object at 0x1114c83d0>
          │                            └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x111049e90>
          └ <function wrap_app_handling_exceptions at 0x106c47060>
  File "/Users/petrvolnov/work/HERE/image-cache/venv/lib/python3.11/site-packages/starlette/_exception_handler.py", line 44, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x111624ea0>
          │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x111630f10>>
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 7001), 'cl...
          └ <fastapi.routing.APIRouter object at 0x1114c83d0>
  File "/Users/petrvolnov/work/HERE/image-cache/venv/lib/python3.11/site-packages/starlette/routing.py", line 746, in __call__
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x111624ea0>
          │     │      │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x111630f10>>
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 7001), 'cl...
          │     └ <function Route.handle at 0x106c6c720>
          └ APIRoute(path='/{path:path}', name='redirect_to_cache', methods=['GET'])
  File "/Users/petrvolnov/work/HERE/image-cache/venv/lib/python3.11/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x111624ea0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x111630f10>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 7001), 'cl...
          │    └ <function request_response.<locals>.app at 0x1114b79c0>
          └ APIRoute(path='/{path:path}', name='redirect_to_cache', methods=['GET'])
  File "/Users/petrvolnov/work/HERE/image-cache/venv/lib/python3.11/site-packages/starlette/routing.py", line 75, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
          │                            │    │        │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x111624ea0>
          │                            │    │        │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x111630f10>>
          │                            │    │        └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 7001), 'cl...
          │                            │    └ <starlette.requests.Request object at 0x111630fd0>
          │                            └ <function request_response.<locals>.app.<locals>.app at 0x111625080>
          └ <function wrap_app_handling_exceptions at 0x106c47060>
  File "/Users/petrvolnov/work/HERE/image-cache/venv/lib/python3.11/site-packages/starlette/_exception_handler.py", line 44, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x111625120>
          │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x111630f10>>
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 7001), 'cl...
          └ <function request_response.<locals>.app.<locals>.app at 0x111625080>
  File "/Users/petrvolnov/work/HERE/image-cache/venv/lib/python3.11/site-packages/starlette/routing.py", line 70, in app
    response = await func(request)
                     │    └ <starlette.requests.Request object at 0x111630fd0>
                     └ <function get_request_handler.<locals>.app at 0x1114b7380>
  File "/Users/petrvolnov/work/HERE/image-cache/venv/lib/python3.11/site-packages/fastapi/routing.py", line 294, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x106c46700>
  File "/Users/petrvolnov/work/HERE/image-cache/venv/lib/python3.11/site-packages/fastapi/routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'path': 'favicon.ico', 'sz': None, 'r': <starlette.requests.Request object at 0x111630fd0>}
                 │         └ <function redirect_to_cache at 0x111498720>
                 └ <fastapi.dependencies.models.Dependant object at 0x1114c97d0>

> File "/Users/petrvolnov/work/HERE/image-cache/src/routes.py", line 138, in redirect_to_cache
    async with session.get(f"https://{url_path}") as response:
               │       └ <function ClientSession.get at 0x1072ad800>
               └ <aiohttp.client.ClientSession object at 0x111631290>

  File "/Users/petrvolnov/work/HERE/image-cache/venv/lib/python3.11/site-packages/aiohttp/client.py", line 1187, in __aenter__
    self._resp = await self._coro
    │    │             │    └ <member '_coro' of '_BaseRequestContextManager' objects>
    │    │             └ <aiohttp.client._RequestContextManager object at 0x111615b70>
    │    └ <member '_resp' of '_BaseRequestContextManager' objects>
    └ <aiohttp.client._RequestContextManager object at 0x111615b70>
  File "/Users/petrvolnov/work/HERE/image-cache/venv/lib/python3.11/site-packages/aiohttp/client.py", line 574, in _request
    conn = await self._connector.connect(
                 │    │          └ <function BaseConnector.connect at 0x1071e02c0>
                 │    └ <aiohttp.connector.TCPConnector object at 0x111631310>
                 └ <aiohttp.client.ClientSession object at 0x111631290>
  File "/Users/petrvolnov/work/HERE/image-cache/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 544, in connect
    proto = await self._create_connection(req, traces, timeout)
                  │    │                  │    │       └ ClientTimeout(total=300, connect=None, sock_read=None, sock_connect=None, ceil_threshold=5)
                  │    │                  │    └ []
                  │    │                  └ <aiohttp.client_reqrep.ClientRequest object at 0x1112d7650>
                  │    └ <function TCPConnector._create_connection at 0x1071e0ea0>
                  └ <aiohttp.connector.TCPConnector object at 0x111631310>
  File "/Users/petrvolnov/work/HERE/image-cache/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 911, in _create_connection
    _, proto = await self._create_direct_connection(req, traces, timeout)
                     │    │                         │    │       └ ClientTimeout(total=300, connect=None, sock_read=None, sock_connect=None, ceil_threshold=5)
                     │    │                         │    └ []
                     │    │                         └ <aiohttp.client_reqrep.ClientRequest object at 0x1112d7650>
                     │    └ <function TCPConnector._create_direct_connection at 0x1071e1580>
                     └ <aiohttp.connector.TCPConnector object at 0x111631310>
  File "/Users/petrvolnov/work/HERE/image-cache/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1187, in _create_direct_connection
    raise ClientConnectorError(req.connection_key, exc) from exc
          │                    │   └ <property object at 0x1071b4db0>
          │                    └ <aiohttp.client_reqrep.ClientRequest object at 0x1112d7650>
          └ <class 'aiohttp.client_exceptions.ClientConnectorError'>

aiohttp.client_exceptions.ClientConnectorError: Cannot connect to host favicon.ico:443 ssl:default [nodename nor servname provided, or not known]
2024-01-02 21:24:31.953 | ERROR    | routes:redirect_to_cache:153 - Cannot connect to host favicon.ico:443 ssl:default [nodename nor servname provided, or not known] favicon.ico
2024-01-02 21:25:07.285 | ERROR    | routes:redirect_to_cache:152 - Cannot connect to host favicon.ico:443 ssl:default [nodename nor servname provided, or not known]
Traceback (most recent call last):

  File "/Users/petrvolnov/work/HERE/image-cache/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1173, in _create_direct_connection
    hosts = await asyncio.shield(host_resolved)
                  │       │      └ <Task finished name='Task-7' coro=<TCPConnector._resolve_host() done, defined at /Users/petrvolnov/work/HERE/image-cache/venv...
                  │       └ <function shield at 0x10210cfe0>
                  └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.11/3.11.6_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/as...
  File "/Users/petrvolnov/work/HERE/image-cache/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 884, in _resolve_host
    addrs = await self._resolver.resolve(host, port, family=self._family)
                  │    │         │       │     │            │    └ 0
                  │    │         │       │     │            └ <aiohttp.connector.TCPConnector object at 0x105587050>
                  │    │         │       │     └ 443
                  │    │         │       └ 'favicon.ico'
                  │    │         └ <function ThreadedResolver.resolve at 0x1047aeac0>
                  │    └ <aiohttp.resolver.ThreadedResolver object at 0x105575e90>
                  └ <aiohttp.connector.TCPConnector object at 0x105587050>
  File "/Users/petrvolnov/work/HERE/image-cache/venv/lib/python3.11/site-packages/aiohttp/resolver.py", line 33, in resolve
    infos = await self._loop.getaddrinfo(
                  │    │     └ <function BaseEventLoop.getaddrinfo at 0x10211a5c0>
                  │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
                  └ <aiohttp.resolver.ThreadedResolver object at 0x105575e90>

  File "/opt/homebrew/Cellar/python@3.11/3.11.6_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 867, in getaddrinfo
    return await self.run_in_executor(
                 │    └ <function BaseEventLoop.run_in_executor at 0x10211a3e0>
                 └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.6_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
             │        │            └ None
             │        └ None
             └ None

  File "/opt/homebrew/Cellar/python@3.11/3.11.6_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/socket.py", line 962, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
               │       │           │     │     │       │     │      └ <AddressInfo.AI_ADDRCONFIG: 1024>
               │       │           │     │     │       │     └ 0
               │       │           │     │     │       └ <SocketKind.SOCK_STREAM: 1>
               │       │           │     │     └ 0
               │       │           │     └ 443
               │       │           └ 'favicon.ico'
               │       └ <built-in function getaddrinfo>
               └ <module '_socket' from '/opt/homebrew/Cellar/python@3.11/3.11.6_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/li...

socket.gaierror: [Errno 8] nodename nor servname provided, or not known


The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "/Users/petrvolnov/work/HERE/image-cache/src/run_web.py", line 73, in <module>
    uvicorn.run(
    │       └ <function run at 0x10287e200>
    └ <module 'uvicorn' from '/Users/petrvolnov/work/HERE/image-cache/venv/lib/python3.11/site-packages/uvicorn/__init__.py'>

  File "/Users/petrvolnov/work/HERE/image-cache/venv/lib/python3.11/site-packages/uvicorn/main.py", line 587, in run
    server.run()
    │      └ <function Server.run at 0x1028bf920>
    └ <uvicorn.server.Server object at 0x10285a850>
  File "/Users/petrvolnov/work/HERE/image-cache/venv/lib/python3.11/site-packages/uvicorn/server.py", line 61, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ None
           │       │   │    └ <function Server.serve at 0x1028bf9c0>
           │       │   └ <uvicorn.server.Server object at 0x10285a850>
           │       └ <function run at 0x1020bc540>
           └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.11/3.11.6_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/as...

  File "/opt/homebrew/Cellar/python@3.11/3.11.6_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           │      │   └ <coroutine object Server.serve at 0x10589f340>
           │      └ <function Runner.run at 0x10211bec0>
           └ <asyncio.runners.Runner object at 0x105584750>

  File "/opt/homebrew/Cellar/python@3.11/3.11.6_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<Server.serve() running at /Users/petrvolnov/work/HERE/image-cache/venv/lib/python3.11/site-...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x102119b20>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x105584750>

  File "/opt/homebrew/Cellar/python@3.11/3.11.6_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x102119a80>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.6_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x10211b880>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.6_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1922, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x102059d00>
    └ <Handle Task.task_wakeup(<Future finis...r not known')>)>

  File "/opt/homebrew/Cellar/python@3.11/3.11.6_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finis...r not known')>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finis...r not known')>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finis...r not known')>)>

  File "/Users/petrvolnov/work/HERE/image-cache/venv/lib/python3.11/site-packages/uvicorn/protocols/http/h11_impl.py", line 408, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x1052ddc90>
  File "/Users/petrvolnov/work/HERE/image-cache/venv/lib/python3.11/site-packages/uvicorn/middleware/proxy_headers.py", line 84, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x1055ff150>>
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x1055ff150>>
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 7001), 'cl...
                 │    └ <fastapi.applications.FastAPI object at 0x1058c8b10>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x1052ddc90>
  File "/Users/petrvolnov/work/HERE/image-cache/venv/lib/python3.11/site-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x1055ff150>>
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x1055ff150>>
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 7001), 'cl...
  File "/Users/petrvolnov/work/HERE/image-cache/venv/lib/python3.11/site-packages/starlette/applications.py", line 116, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x1055ff150>>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x1055ff150>>
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 7001), 'cl...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x105585f10>
          └ <fastapi.applications.FastAPI object at 0x1058c8b10>
  File "/Users/petrvolnov/work/HERE/image-cache/venv/lib/python3.11/site-packages/starlette/middleware/errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x1058d0040>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x1055ff150>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 7001), 'cl...
          │    └ <starlette.middleware.cors.CORSMiddleware object at 0x1052ef090>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x105585f10>
  File "/Users/petrvolnov/work/HERE/image-cache/venv/lib/python3.11/site-packages/starlette/middleware/cors.py", line 83, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x1058d0040>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x1055ff150>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 7001), 'cl...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x1052ecf90>
          └ <starlette.middleware.cors.CORSMiddleware object at 0x1052ef090>
  File "/Users/petrvolnov/work/HERE/image-cache/venv/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
          │                            │    │    │     │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x1058d0040>
          │                            │    │    │     │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x1055ff150>>
          │                            │    │    │     └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 7001), 'cl...
          │                            │    │    └ <starlette.requests.Request object at 0x10556b9d0>
          │                            │    └ <fastapi.routing.APIRouter object at 0x1058c8c10>
          │                            └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x1052ecf90>
          └ <function wrap_app_handling_exceptions at 0x10438f060>
  File "/Users/petrvolnov/work/HERE/image-cache/venv/lib/python3.11/site-packages/starlette/_exception_handler.py", line 44, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x105a24fe0>
          │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x1055ff150>>
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 7001), 'cl...
          └ <fastapi.routing.APIRouter object at 0x1058c8c10>
  File "/Users/petrvolnov/work/HERE/image-cache/venv/lib/python3.11/site-packages/starlette/routing.py", line 746, in __call__
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x105a24fe0>
          │     │      │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x1055ff150>>
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 7001), 'cl...
          │     └ <function Route.handle at 0x1043b4720>
          └ APIRoute(path='/{path:path}', name='redirect_to_cache', methods=['GET'])
  File "/Users/petrvolnov/work/HERE/image-cache/venv/lib/python3.11/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x105a24fe0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x1055ff150>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 7001), 'cl...
          │    └ <function request_response.<locals>.app at 0x1058b79c0>
          └ APIRoute(path='/{path:path}', name='redirect_to_cache', methods=['GET'])
  File "/Users/petrvolnov/work/HERE/image-cache/venv/lib/python3.11/site-packages/starlette/routing.py", line 75, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
          │                            │    │        │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x105a24fe0>
          │                            │    │        │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x1055ff150>>
          │                            │    │        └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 7001), 'cl...
          │                            │    └ <starlette.requests.Request object at 0x105569610>
          │                            └ <function request_response.<locals>.app.<locals>.app at 0x105a25080>
          └ <function wrap_app_handling_exceptions at 0x10438f060>
  File "/Users/petrvolnov/work/HERE/image-cache/venv/lib/python3.11/site-packages/starlette/_exception_handler.py", line 44, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x105a251c0>
          │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x1055ff150>>
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 7001), 'cl...
          └ <function request_response.<locals>.app.<locals>.app at 0x105a25080>
  File "/Users/petrvolnov/work/HERE/image-cache/venv/lib/python3.11/site-packages/starlette/routing.py", line 70, in app
    response = await func(request)
                     │    └ <starlette.requests.Request object at 0x105569610>
                     └ <function get_request_handler.<locals>.app at 0x1058b7380>
  File "/Users/petrvolnov/work/HERE/image-cache/venv/lib/python3.11/site-packages/fastapi/routing.py", line 294, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x10438e700>
  File "/Users/petrvolnov/work/HERE/image-cache/venv/lib/python3.11/site-packages/fastapi/routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'path': 'favicon.ico', 'sz': None, 'r': <starlette.requests.Request object at 0x105569610>}
                 │         └ <function redirect_to_cache at 0x105898720>
                 └ <fastapi.dependencies.models.Dependant object at 0x1058c9f90>

> File "/Users/petrvolnov/work/HERE/image-cache/src/routes.py", line 138, in redirect_to_cache
    async with session.get(f"https://{url_path}") as response:
               │       └ <function ClientSession.get at 0x10496d800>
               └ <aiohttp.client.ClientSession object at 0x105a30a90>

  File "/Users/petrvolnov/work/HERE/image-cache/venv/lib/python3.11/site-packages/aiohttp/client.py", line 1187, in __aenter__
    self._resp = await self._coro
    │    │             │    └ <member '_coro' of '_BaseRequestContextManager' objects>
    │    │             └ <aiohttp.client._RequestContextManager object at 0x105a15e10>
    │    └ <member '_resp' of '_BaseRequestContextManager' objects>
    └ <aiohttp.client._RequestContextManager object at 0x105a15e10>
  File "/Users/petrvolnov/work/HERE/image-cache/venv/lib/python3.11/site-packages/aiohttp/client.py", line 574, in _request
    conn = await self._connector.connect(
                 │    │          └ <function BaseConnector.connect at 0x1047d82c0>
                 │    └ <aiohttp.connector.TCPConnector object at 0x105587050>
                 └ <aiohttp.client.ClientSession object at 0x105a30a90>
  File "/Users/petrvolnov/work/HERE/image-cache/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 544, in connect
    proto = await self._create_connection(req, traces, timeout)
                  │    │                  │    │       └ ClientTimeout(total=300, connect=None, sock_read=None, sock_connect=None, ceil_threshold=5)
                  │    │                  │    └ []
                  │    │                  └ <aiohttp.client_reqrep.ClientRequest object at 0x1052edb10>
                  │    └ <function TCPConnector._create_connection at 0x1047d8ea0>
                  └ <aiohttp.connector.TCPConnector object at 0x105587050>
  File "/Users/petrvolnov/work/HERE/image-cache/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 911, in _create_connection
    _, proto = await self._create_direct_connection(req, traces, timeout)
                     │    │                         │    │       └ ClientTimeout(total=300, connect=None, sock_read=None, sock_connect=None, ceil_threshold=5)
                     │    │                         │    └ []
                     │    │                         └ <aiohttp.client_reqrep.ClientRequest object at 0x1052edb10>
                     │    └ <function TCPConnector._create_direct_connection at 0x1047d9580>
                     └ <aiohttp.connector.TCPConnector object at 0x105587050>
  File "/Users/petrvolnov/work/HERE/image-cache/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1187, in _create_direct_connection
    raise ClientConnectorError(req.connection_key, exc) from exc
          │                    │   └ <property object at 0x1047b1120>
          │                    └ <aiohttp.client_reqrep.ClientRequest object at 0x1052edb10>
          └ <class 'aiohttp.client_exceptions.ClientConnectorError'>

aiohttp.client_exceptions.ClientConnectorError: Cannot connect to host favicon.ico:443 ssl:default [nodename nor servname provided, or not known]
2024-01-02 21:25:07.315 | ERROR    | routes:redirect_to_cache:153 - Cannot connect to host favicon.ico:443 ssl:default [nodename nor servname provided, or not known] favicon.ico
2024-01-02 21:25:10.108 | ERROR    | routes:redirect_to_cache:152 - Cannot connect to host favicon.ico:443 ssl:default [nodename nor servname provided, or not known]
Traceback (most recent call last):

  File "/Users/petrvolnov/work/HERE/image-cache/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1173, in _create_direct_connection
    hosts = await asyncio.shield(host_resolved)
                  │       │      └ <Task finished name='Task-11' coro=<TCPConnector._resolve_host() done, defined at /Users/petrvolnov/work/HERE/image-cache/ven...
                  │       └ <function shield at 0x10210cfe0>
                  └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.11/3.11.6_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/as...
  File "/Users/petrvolnov/work/HERE/image-cache/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 884, in _resolve_host
    addrs = await self._resolver.resolve(host, port, family=self._family)
                  │    │         │       │     │            │    └ 0
                  │    │         │       │     │            └ <aiohttp.connector.TCPConnector object at 0x105de7f90>
                  │    │         │       │     └ 443
                  │    │         │       └ 'favicon.ico'
                  │    │         └ <function ThreadedResolver.resolve at 0x1047aeac0>
                  │    └ <aiohttp.resolver.ThreadedResolver object at 0x105586010>
                  └ <aiohttp.connector.TCPConnector object at 0x105de7f90>
  File "/Users/petrvolnov/work/HERE/image-cache/venv/lib/python3.11/site-packages/aiohttp/resolver.py", line 33, in resolve
    infos = await self._loop.getaddrinfo(
                  │    │     └ <function BaseEventLoop.getaddrinfo at 0x10211a5c0>
                  │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
                  └ <aiohttp.resolver.ThreadedResolver object at 0x105586010>

  File "/opt/homebrew/Cellar/python@3.11/3.11.6_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 867, in getaddrinfo
    return await self.run_in_executor(
                 │    └ <function BaseEventLoop.run_in_executor at 0x10211a3e0>
                 └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.6_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
             │        │            └ None
             │        └ None
             └ None

  File "/opt/homebrew/Cellar/python@3.11/3.11.6_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/socket.py", line 962, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
               │       │           │     │     │       │     │      └ <AddressInfo.AI_ADDRCONFIG: 1024>
               │       │           │     │     │       │     └ 0
               │       │           │     │     │       └ <SocketKind.SOCK_STREAM: 1>
               │       │           │     │     └ 0
               │       │           │     └ 443
               │       │           └ 'favicon.ico'
               │       └ <built-in function getaddrinfo>
               └ <module '_socket' from '/opt/homebrew/Cellar/python@3.11/3.11.6_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/li...

socket.gaierror: [Errno 8] nodename nor servname provided, or not known


The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "/Users/petrvolnov/work/HERE/image-cache/src/run_web.py", line 73, in <module>
    uvicorn.run(
    │       └ <function run at 0x10287e200>
    └ <module 'uvicorn' from '/Users/petrvolnov/work/HERE/image-cache/venv/lib/python3.11/site-packages/uvicorn/__init__.py'>

  File "/Users/petrvolnov/work/HERE/image-cache/venv/lib/python3.11/site-packages/uvicorn/main.py", line 587, in run
    server.run()
    │      └ <function Server.run at 0x1028bf920>
    └ <uvicorn.server.Server object at 0x10285a850>
  File "/Users/petrvolnov/work/HERE/image-cache/venv/lib/python3.11/site-packages/uvicorn/server.py", line 61, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ None
           │       │   │    └ <function Server.serve at 0x1028bf9c0>
           │       │   └ <uvicorn.server.Server object at 0x10285a850>
           │       └ <function run at 0x1020bc540>
           └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.11/3.11.6_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/as...

  File "/opt/homebrew/Cellar/python@3.11/3.11.6_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           │      │   └ <coroutine object Server.serve at 0x10589f340>
           │      └ <function Runner.run at 0x10211bec0>
           └ <asyncio.runners.Runner object at 0x105584750>

  File "/opt/homebrew/Cellar/python@3.11/3.11.6_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<Server.serve() running at /Users/petrvolnov/work/HERE/image-cache/venv/lib/python3.11/site-...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x102119b20>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x105584750>

  File "/opt/homebrew/Cellar/python@3.11/3.11.6_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x102119a80>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.6_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x10211b880>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.6_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1922, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x102059d00>
    └ <Handle Task.task_wakeup(<Future finis...r not known')>)>

  File "/opt/homebrew/Cellar/python@3.11/3.11.6_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finis...r not known')>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finis...r not known')>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finis...r not known')>)>

  File "/Users/petrvolnov/work/HERE/image-cache/venv/lib/python3.11/site-packages/uvicorn/protocols/http/h11_impl.py", line 408, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x1052ddc90>
  File "/Users/petrvolnov/work/HERE/image-cache/venv/lib/python3.11/site-packages/uvicorn/middleware/proxy_headers.py", line 84, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x105de7910>>
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x105de7910>>
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 7001), 'cl...
                 │    └ <fastapi.applications.FastAPI object at 0x1058c8b10>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x1052ddc90>
  File "/Users/petrvolnov/work/HERE/image-cache/venv/lib/python3.11/site-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x105de7910>>
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x105de7910>>
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 7001), 'cl...
  File "/Users/petrvolnov/work/HERE/image-cache/venv/lib/python3.11/site-packages/starlette/applications.py", line 116, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x105de7910>>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x105de7910>>
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 7001), 'cl...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x105585f10>
          └ <fastapi.applications.FastAPI object at 0x1058c8b10>
  File "/Users/petrvolnov/work/HERE/image-cache/venv/lib/python3.11/site-packages/starlette/middleware/errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x105a251c0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x105de7910>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 7001), 'cl...
          │    └ <starlette.middleware.cors.CORSMiddleware object at 0x1052ef090>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x105585f10>
  File "/Users/petrvolnov/work/HERE/image-cache/venv/lib/python3.11/site-packages/starlette/middleware/cors.py", line 83, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x105a251c0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x105de7910>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 7001), 'cl...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x1052ecf90>
          └ <starlette.middleware.cors.CORSMiddleware object at 0x1052ef090>
  File "/Users/petrvolnov/work/HERE/image-cache/venv/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
          │                            │    │    │     │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x105a251c0>
          │                            │    │    │     │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x105de7910>>
          │                            │    │    │     └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 7001), 'cl...
          │                            │    │    └ <starlette.requests.Request object at 0x105de7c10>
          │                            │    └ <fastapi.routing.APIRouter object at 0x1058c8c10>
          │                            └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x1052ecf90>
          └ <function wrap_app_handling_exceptions at 0x10438f060>
  File "/Users/petrvolnov/work/HERE/image-cache/venv/lib/python3.11/site-packages/starlette/_exception_handler.py", line 44, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x105a254e0>
          │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x105de7910>>
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 7001), 'cl...
          └ <fastapi.routing.APIRouter object at 0x1058c8c10>
  File "/Users/petrvolnov/work/HERE/image-cache/venv/lib/python3.11/site-packages/starlette/routing.py", line 746, in __call__
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x105a254e0>
          │     │      │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x105de7910>>
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 7001), 'cl...
          │     └ <function Route.handle at 0x1043b4720>
          └ APIRoute(path='/{path:path}', name='redirect_to_cache', methods=['GET'])
  File "/Users/petrvolnov/work/HERE/image-cache/venv/lib/python3.11/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x105a254e0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x105de7910>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 7001), 'cl...
          │    └ <function request_response.<locals>.app at 0x1058b79c0>
          └ APIRoute(path='/{path:path}', name='redirect_to_cache', methods=['GET'])
  File "/Users/petrvolnov/work/HERE/image-cache/venv/lib/python3.11/site-packages/starlette/routing.py", line 75, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
          │                            │    │        │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x105a254e0>
          │                            │    │        │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x105de7910>>
          │                            │    │        └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 7001), 'cl...
          │                            │    └ <starlette.requests.Request object at 0x105de7d10>
          │                            └ <function request_response.<locals>.app.<locals>.app at 0x105d48ea0>
          └ <function wrap_app_handling_exceptions at 0x10438f060>
  File "/Users/petrvolnov/work/HERE/image-cache/venv/lib/python3.11/site-packages/starlette/_exception_handler.py", line 44, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x105d48fe0>
          │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x105de7910>>
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 7001), 'cl...
          └ <function request_response.<locals>.app.<locals>.app at 0x105d48ea0>
  File "/Users/petrvolnov/work/HERE/image-cache/venv/lib/python3.11/site-packages/starlette/routing.py", line 70, in app
    response = await func(request)
                     │    └ <starlette.requests.Request object at 0x105de7d10>
                     └ <function get_request_handler.<locals>.app at 0x1058b7380>
  File "/Users/petrvolnov/work/HERE/image-cache/venv/lib/python3.11/site-packages/fastapi/routing.py", line 294, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x10438e700>
  File "/Users/petrvolnov/work/HERE/image-cache/venv/lib/python3.11/site-packages/fastapi/routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'path': 'favicon.ico', 'sz': None, 'r': <starlette.requests.Request object at 0x105de7d10>}
                 │         └ <function redirect_to_cache at 0x105898720>
                 └ <fastapi.dependencies.models.Dependant object at 0x1058c9f90>

> File "/Users/petrvolnov/work/HERE/image-cache/src/routes.py", line 138, in redirect_to_cache
    async with session.get(f"https://{url_path}") as response:
               │       └ <function ClientSession.get at 0x10496d800>
               └ <aiohttp.client.ClientSession object at 0x105de7f10>

  File "/Users/petrvolnov/work/HERE/image-cache/venv/lib/python3.11/site-packages/aiohttp/client.py", line 1187, in __aenter__
    self._resp = await self._coro
    │    │             │    └ <member '_coro' of '_BaseRequestContextManager' objects>
    │    │             └ <aiohttp.client._RequestContextManager object at 0x105a159f0>
    │    └ <member '_resp' of '_BaseRequestContextManager' objects>
    └ <aiohttp.client._RequestContextManager object at 0x105a159f0>
  File "/Users/petrvolnov/work/HERE/image-cache/venv/lib/python3.11/site-packages/aiohttp/client.py", line 574, in _request
    conn = await self._connector.connect(
                 │    │          └ <function BaseConnector.connect at 0x1047d82c0>
                 │    └ <aiohttp.connector.TCPConnector object at 0x105de7f90>
                 └ <aiohttp.client.ClientSession object at 0x105de7f10>
  File "/Users/petrvolnov/work/HERE/image-cache/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 544, in connect
    proto = await self._create_connection(req, traces, timeout)
                  │    │                  │    │       └ ClientTimeout(total=300, connect=None, sock_read=None, sock_connect=None, ceil_threshold=5)
                  │    │                  │    └ []
                  │    │                  └ <aiohttp.client_reqrep.ClientRequest object at 0x105e00150>
                  │    └ <function TCPConnector._create_connection at 0x1047d8ea0>
                  └ <aiohttp.connector.TCPConnector object at 0x105de7f90>
  File "/Users/petrvolnov/work/HERE/image-cache/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 911, in _create_connection
    _, proto = await self._create_direct_connection(req, traces, timeout)
                     │    │                         │    │       └ ClientTimeout(total=300, connect=None, sock_read=None, sock_connect=None, ceil_threshold=5)
                     │    │                         │    └ []
                     │    │                         └ <aiohttp.client_reqrep.ClientRequest object at 0x105e00150>
                     │    └ <function TCPConnector._create_direct_connection at 0x1047d9580>
                     └ <aiohttp.connector.TCPConnector object at 0x105de7f90>
  File "/Users/petrvolnov/work/HERE/image-cache/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1187, in _create_direct_connection
    raise ClientConnectorError(req.connection_key, exc) from exc
          │                    │   └ <property object at 0x1047b1120>
          │                    └ <aiohttp.client_reqrep.ClientRequest object at 0x105e00150>
          └ <class 'aiohttp.client_exceptions.ClientConnectorError'>

aiohttp.client_exceptions.ClientConnectorError: Cannot connect to host favicon.ico:443 ssl:default [nodename nor servname provided, or not known]
2024-01-02 21:25:10.125 | ERROR    | routes:redirect_to_cache:153 - Cannot connect to host favicon.ico:443 ssl:default [nodename nor servname provided, or not known] favicon.ico
2024-01-02 21:25:36.527 | ERROR    | routes:redirect_to_cache:152 - Cannot connect to host favicon.ico:443 ssl:default [nodename nor servname provided, or not known]
Traceback (most recent call last):

  File "/Users/petrvolnov/work/HERE/image-cache/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1173, in _create_direct_connection
    hosts = await asyncio.shield(host_resolved)
                  │       │      └ <Task finished name='Task-7' coro=<TCPConnector._resolve_host() done, defined at /Users/petrvolnov/work/HERE/image-cache/venv...
                  │       └ <function shield at 0x101ca8fe0>
                  └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.11/3.11.6_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/as...
  File "/Users/petrvolnov/work/HERE/image-cache/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 884, in _resolve_host
    addrs = await self._resolver.resolve(host, port, family=self._family)
                  │    │         │       │     │            │    └ 0
                  │    │         │       │     │            └ <aiohttp.connector.TCPConnector object at 0x10425e150>
                  │    │         │       │     └ 443
                  │    │         │       └ 'favicon.ico'
                  │    │         └ <function ThreadedResolver.resolve at 0x1036beac0>
                  │    └ <aiohttp.resolver.ThreadedResolver object at 0x10402e010>
                  └ <aiohttp.connector.TCPConnector object at 0x10425e150>
  File "/Users/petrvolnov/work/HERE/image-cache/venv/lib/python3.11/site-packages/aiohttp/resolver.py", line 33, in resolve
    infos = await self._loop.getaddrinfo(
                  │    │     └ <function BaseEventLoop.getaddrinfo at 0x101cb65c0>
                  │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
                  └ <aiohttp.resolver.ThreadedResolver object at 0x10402e010>

  File "/opt/homebrew/Cellar/python@3.11/3.11.6_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 867, in getaddrinfo
    return await self.run_in_executor(
                 │    └ <function BaseEventLoop.run_in_executor at 0x101cb63e0>
                 └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.6_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
             │        │            └ None
             │        └ None
             └ None

  File "/opt/homebrew/Cellar/python@3.11/3.11.6_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/socket.py", line 962, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
               │       │           │     │     │       │     │      └ <AddressInfo.AI_ADDRCONFIG: 1024>
               │       │           │     │     │       │     └ 0
               │       │           │     │     │       └ <SocketKind.SOCK_STREAM: 1>
               │       │           │     │     └ 0
               │       │           │     └ 443
               │       │           └ 'favicon.ico'
               │       └ <built-in function getaddrinfo>
               └ <module '_socket' from '/opt/homebrew/Cellar/python@3.11/3.11.6_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/li...

socket.gaierror: [Errno 8] nodename nor servname provided, or not known


The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "/Users/petrvolnov/work/HERE/image-cache/src/run_web.py", line 73, in <module>
    uvicorn.run(
    │       └ <function run at 0x101f1a200>
    └ <module 'uvicorn' from '/Users/petrvolnov/work/HERE/image-cache/venv/lib/python3.11/site-packages/uvicorn/__init__.py'>

  File "/Users/petrvolnov/work/HERE/image-cache/venv/lib/python3.11/site-packages/uvicorn/main.py", line 587, in run
    server.run()
    │      └ <function Server.run at 0x101f5b920>
    └ <uvicorn.server.Server object at 0x101ef6b90>
  File "/Users/petrvolnov/work/HERE/image-cache/venv/lib/python3.11/site-packages/uvicorn/server.py", line 61, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ None
           │       │   │    └ <function Server.serve at 0x101f5b9c0>
           │       │   └ <uvicorn.server.Server object at 0x101ef6b90>
           │       └ <function run at 0x101c58540>
           └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.11/3.11.6_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/as...

  File "/opt/homebrew/Cellar/python@3.11/3.11.6_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           │      │   └ <coroutine object Server.serve at 0x104407340>
           │      └ <function Runner.run at 0x101cb7ec0>
           └ <asyncio.runners.Runner object at 0x103fcc9d0>

  File "/opt/homebrew/Cellar/python@3.11/3.11.6_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<Server.serve() running at /Users/petrvolnov/work/HERE/image-cache/venv/lib/python3.11/site-...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x101cb5b20>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x103fcc9d0>

  File "/opt/homebrew/Cellar/python@3.11/3.11.6_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x101cb5a80>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.6_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x101cb7880>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.6_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1922, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x101bf5d00>
    └ <Handle Task.task_wakeup(<Future finis...r not known')>)>

  File "/opt/homebrew/Cellar/python@3.11/3.11.6_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finis...r not known')>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finis...r not known')>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finis...r not known')>)>

  File "/Users/petrvolnov/work/HERE/image-cache/venv/lib/python3.11/site-packages/uvicorn/protocols/http/h11_impl.py", line 408, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x103fb3ad0>
  File "/Users/petrvolnov/work/HERE/image-cache/venv/lib/python3.11/site-packages/uvicorn/middleware/proxy_headers.py", line 84, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x1044904d0>>
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x1044904d0>>
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 7001), 'cl...
                 │    └ <fastapi.applications.FastAPI object at 0x104430950>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x103fb3ad0>
  File "/Users/petrvolnov/work/HERE/image-cache/venv/lib/python3.11/site-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x1044904d0>>
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x1044904d0>>
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 7001), 'cl...
  File "/Users/petrvolnov/work/HERE/image-cache/venv/lib/python3.11/site-packages/starlette/applications.py", line 116, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x1044904d0>>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x1044904d0>>
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 7001), 'cl...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x10425e550>
          └ <fastapi.applications.FastAPI object at 0x104430950>
  File "/Users/petrvolnov/work/HERE/image-cache/venv/lib/python3.11/site-packages/starlette/middleware/errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x104438040>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x1044904d0>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 7001), 'cl...
          │    └ <starlette.middleware.cors.CORSMiddleware object at 0x10425c790>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x10425e550>
  File "/Users/petrvolnov/work/HERE/image-cache/venv/lib/python3.11/site-packages/starlette/middleware/cors.py", line 83, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x104438040>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x1044904d0>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 7001), 'cl...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x10425ce10>
          └ <starlette.middleware.cors.CORSMiddleware object at 0x10425c790>
  File "/Users/petrvolnov/work/HERE/image-cache/venv/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
          │                            │    │    │     │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x104438040>
          │                            │    │    │     │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x1044904d0>>
          │                            │    │    │     └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 7001), 'cl...
          │                            │    │    └ <starlette.requests.Request object at 0x1044911d0>
          │                            │    └ <fastapi.routing.APIRouter object at 0x104430b10>
          │                            └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x10425ce10>
          └ <function wrap_app_handling_exceptions at 0x10314b060>
  File "/Users/petrvolnov/work/HERE/image-cache/venv/lib/python3.11/site-packages/starlette/_exception_handler.py", line 44, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x10448cfe0>
          │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x1044904d0>>
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 7001), 'cl...
          └ <fastapi.routing.APIRouter object at 0x104430b10>
  File "/Users/petrvolnov/work/HERE/image-cache/venv/lib/python3.11/site-packages/starlette/routing.py", line 746, in __call__
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x10448cfe0>
          │     │      │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x1044904d0>>
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 7001), 'cl...
          │     └ <function Route.handle at 0x103170720>
          └ APIRoute(path='/{path:path}', name='redirect_to_cache', methods=['GET'])
  File "/Users/petrvolnov/work/HERE/image-cache/venv/lib/python3.11/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x10448cfe0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x1044904d0>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 7001), 'cl...
          │    └ <function request_response.<locals>.app at 0x10441f9c0>
          └ APIRoute(path='/{path:path}', name='redirect_to_cache', methods=['GET'])
  File "/Users/petrvolnov/work/HERE/image-cache/venv/lib/python3.11/site-packages/starlette/routing.py", line 75, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
          │                            │    │        │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x10448cfe0>
          │                            │    │        │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x1044904d0>>
          │                            │    │        └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 7001), 'cl...
          │                            │    └ <starlette.requests.Request object at 0x104490f90>
          │                            └ <function request_response.<locals>.app.<locals>.app at 0x10448d080>
          └ <function wrap_app_handling_exceptions at 0x10314b060>
  File "/Users/petrvolnov/work/HERE/image-cache/venv/lib/python3.11/site-packages/starlette/_exception_handler.py", line 44, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x10448d1c0>
          │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x1044904d0>>
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 7001), 'cl...
          └ <function request_response.<locals>.app.<locals>.app at 0x10448d080>
  File "/Users/petrvolnov/work/HERE/image-cache/venv/lib/python3.11/site-packages/starlette/routing.py", line 70, in app
    response = await func(request)
                     │    └ <starlette.requests.Request object at 0x104490f90>
                     └ <function get_request_handler.<locals>.app at 0x10441f380>
  File "/Users/petrvolnov/work/HERE/image-cache/venv/lib/python3.11/site-packages/fastapi/routing.py", line 294, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x10314a700>
  File "/Users/petrvolnov/work/HERE/image-cache/venv/lib/python3.11/site-packages/fastapi/routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'path': 'favicon.ico', 'sz': None, 'r': <starlette.requests.Request object at 0x104490f90>}
                 │         └ <function redirect_to_cache at 0x104400720>
                 └ <fastapi.dependencies.models.Dependant object at 0x104431e90>

> File "/Users/petrvolnov/work/HERE/image-cache/src/routes.py", line 138, in redirect_to_cache
    async with session.get(f"https://{url_path}") as response:
               │       └ <function ClientSession.get at 0x1037b1800>
               └ <aiohttp.client.ClientSession object at 0x104491450>

  File "/Users/petrvolnov/work/HERE/image-cache/venv/lib/python3.11/site-packages/aiohttp/client.py", line 1187, in __aenter__
    self._resp = await self._coro
    │    │             │    └ <member '_coro' of '_BaseRequestContextManager' objects>
    │    │             └ <aiohttp.client._RequestContextManager object at 0x10447ded0>
    │    └ <member '_resp' of '_BaseRequestContextManager' objects>
    └ <aiohttp.client._RequestContextManager object at 0x10447ded0>
  File "/Users/petrvolnov/work/HERE/image-cache/venv/lib/python3.11/site-packages/aiohttp/client.py", line 574, in _request
    conn = await self._connector.connect(
                 │    │          └ <function BaseConnector.connect at 0x1036e42c0>
                 │    └ <aiohttp.connector.TCPConnector object at 0x10425e150>
                 └ <aiohttp.client.ClientSession object at 0x104491450>
  File "/Users/petrvolnov/work/HERE/image-cache/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 544, in connect
    proto = await self._create_connection(req, traces, timeout)
                  │    │                  │    │       └ ClientTimeout(total=300, connect=None, sock_read=None, sock_connect=None, ceil_threshold=5)
                  │    │                  │    └ []
                  │    │                  └ <aiohttp.client_reqrep.ClientRequest object at 0x10424cf10>
                  │    └ <function TCPConnector._create_connection at 0x1036e4ea0>
                  └ <aiohttp.connector.TCPConnector object at 0x10425e150>
  File "/Users/petrvolnov/work/HERE/image-cache/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 911, in _create_connection
    _, proto = await self._create_direct_connection(req, traces, timeout)
                     │    │                         │    │       └ ClientTimeout(total=300, connect=None, sock_read=None, sock_connect=None, ceil_threshold=5)
                     │    │                         │    └ []
                     │    │                         └ <aiohttp.client_reqrep.ClientRequest object at 0x10424cf10>
                     │    └ <function TCPConnector._create_direct_connection at 0x1036e5580>
                     └ <aiohttp.connector.TCPConnector object at 0x10425e150>
  File "/Users/petrvolnov/work/HERE/image-cache/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1187, in _create_direct_connection
    raise ClientConnectorError(req.connection_key, exc) from exc
          │                    │   └ <property object at 0x1036b8ef0>
          │                    └ <aiohttp.client_reqrep.ClientRequest object at 0x10424cf10>
          └ <class 'aiohttp.client_exceptions.ClientConnectorError'>

aiohttp.client_exceptions.ClientConnectorError: Cannot connect to host favicon.ico:443 ssl:default [nodename nor servname provided, or not known]
2024-01-02 21:25:36.562 | ERROR    | routes:redirect_to_cache:153 - Cannot connect to host favicon.ico:443 ssl:default [nodename nor servname provided, or not known] favicon.ico
2024-01-02 21:26:47.220 | ERROR    | routes:redirect_to_cache:152 - Cannot connect to host favicon.ico:443 ssl:default [nodename nor servname provided, or not known]
Traceback (most recent call last):

  File "/Users/petrvolnov/work/HERE/image-cache/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1173, in _create_direct_connection
    hosts = await asyncio.shield(host_resolved)
                  │       │      └ <Task finished name='Task-7' coro=<TCPConnector._resolve_host() done, defined at /Users/petrvolnov/work/HERE/image-cache/venv...
                  │       └ <function shield at 0x101210fe0>
                  └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.11/3.11.6_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/as...
  File "/Users/petrvolnov/work/HERE/image-cache/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 884, in _resolve_host
    addrs = await self._resolver.resolve(host, port, family=self._family)
                  │    │         │       │     │            │    └ 0
                  │    │         │       │     │            └ <aiohttp.connector.TCPConnector object at 0x103595350>
                  │    │         │       │     └ 443
                  │    │         │       └ 'favicon.ico'
                  │    │         └ <function ThreadedResolver.resolve at 0x102c26ac0>
                  │    └ <aiohttp.resolver.ThreadedResolver object at 0x103a00b50>
                  └ <aiohttp.connector.TCPConnector object at 0x103595350>
  File "/Users/petrvolnov/work/HERE/image-cache/venv/lib/python3.11/site-packages/aiohttp/resolver.py", line 33, in resolve
    infos = await self._loop.getaddrinfo(
                  │    │     └ <function BaseEventLoop.getaddrinfo at 0x10121e5c0>
                  │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
                  └ <aiohttp.resolver.ThreadedResolver object at 0x103a00b50>

  File "/opt/homebrew/Cellar/python@3.11/3.11.6_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 867, in getaddrinfo
    return await self.run_in_executor(
                 │    └ <function BaseEventLoop.run_in_executor at 0x10121e3e0>
                 └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.6_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
             │        │            └ None
             │        └ None
             └ None

  File "/opt/homebrew/Cellar/python@3.11/3.11.6_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/socket.py", line 962, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
               │       │           │     │     │       │     │      └ <AddressInfo.AI_ADDRCONFIG: 1024>
               │       │           │     │     │       │     └ 0
               │       │           │     │     │       └ <SocketKind.SOCK_STREAM: 1>
               │       │           │     │     └ 0
               │       │           │     └ 443
               │       │           └ 'favicon.ico'
               │       └ <built-in function getaddrinfo>
               └ <module '_socket' from '/opt/homebrew/Cellar/python@3.11/3.11.6_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/li...

socket.gaierror: [Errno 8] nodename nor servname provided, or not known


The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "/Users/petrvolnov/work/HERE/image-cache/src/run_web.py", line 73, in <module>
    uvicorn.run(
    │       └ <function run at 0x101482200>
    └ <module 'uvicorn' from '/Users/petrvolnov/work/HERE/image-cache/venv/lib/python3.11/site-packages/uvicorn/__init__.py'>

  File "/Users/petrvolnov/work/HERE/image-cache/venv/lib/python3.11/site-packages/uvicorn/main.py", line 587, in run
    server.run()
    │      └ <function Server.run at 0x1014c3920>
    └ <uvicorn.server.Server object at 0x10379f710>
  File "/Users/petrvolnov/work/HERE/image-cache/venv/lib/python3.11/site-packages/uvicorn/server.py", line 61, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ None
           │       │   │    └ <function Server.serve at 0x1014c39c0>
           │       │   └ <uvicorn.server.Server object at 0x10379f710>
           │       └ <function run at 0x1011c0540>
           └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.11/3.11.6_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/as...

  File "/opt/homebrew/Cellar/python@3.11/3.11.6_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           │      │   └ <coroutine object Server.serve at 0x10396b340>
           │      └ <function Runner.run at 0x10121fec0>
           └ <asyncio.runners.Runner object at 0x103833d50>

  File "/opt/homebrew/Cellar/python@3.11/3.11.6_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<Server.serve() running at /Users/petrvolnov/work/HERE/image-cache/venv/lib/python3.11/site-...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x10121db20>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x103833d50>

  File "/opt/homebrew/Cellar/python@3.11/3.11.6_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x10121da80>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.6_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x10121f880>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.6_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1922, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x10115dd00>
    └ <Handle Task.task_wakeup(<Future finis...r not known')>)>

  File "/opt/homebrew/Cellar/python@3.11/3.11.6_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finis...r not known')>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finis...r not known')>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finis...r not known')>)>

  File "/Users/petrvolnov/work/HERE/image-cache/venv/lib/python3.11/site-packages/uvicorn/protocols/http/h11_impl.py", line 408, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x10351bad0>
  File "/Users/petrvolnov/work/HERE/image-cache/venv/lib/python3.11/site-packages/uvicorn/middleware/proxy_headers.py", line 84, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x10379f9d0>>
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x10379f9d0>>
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 7001), 'cl...
                 │    └ <fastapi.applications.FastAPI object at 0x103998410>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x10351bad0>
  File "/Users/petrvolnov/work/HERE/image-cache/venv/lib/python3.11/site-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x10379f9d0>>
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x10379f9d0>>
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 7001), 'cl...
  File "/Users/petrvolnov/work/HERE/image-cache/venv/lib/python3.11/site-packages/starlette/applications.py", line 116, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x10379f9d0>>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x10379f9d0>>
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 7001), 'cl...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x1037b5250>
          └ <fastapi.applications.FastAPI object at 0x103998410>
  File "/Users/petrvolnov/work/HERE/image-cache/venv/lib/python3.11/site-packages/starlette/middleware/errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x1039f4ea0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x10379f9d0>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 7001), 'cl...
          │    └ <starlette.middleware.cors.CORSMiddleware object at 0x1037b4b10>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x1037b5250>
  File "/Users/petrvolnov/work/HERE/image-cache/venv/lib/python3.11/site-packages/starlette/middleware/cors.py", line 83, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x1039f4ea0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x10379f9d0>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 7001), 'cl...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x1037b4850>
          └ <starlette.middleware.cors.CORSMiddleware object at 0x1037b4b10>
  File "/Users/petrvolnov/work/HERE/image-cache/venv/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
          │                            │    │    │     │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x1039f4ea0>
          │                            │    │    │     │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x10379f9d0>>
          │                            │    │    │     └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 7001), 'cl...
          │                            │    │    └ <starlette.requests.Request object at 0x10379f250>
          │                            │    └ <fastapi.routing.APIRouter object at 0x1039984d0>
          │                            └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x1037b4850>
          └ <function wrap_app_handling_exceptions at 0x1026b3060>
  File "/Users/petrvolnov/work/HERE/image-cache/venv/lib/python3.11/site-packages/starlette/_exception_handler.py", line 44, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x1039f5080>
          │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x10379f9d0>>
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 7001), 'cl...
          └ <fastapi.routing.APIRouter object at 0x1039984d0>
  File "/Users/petrvolnov/work/HERE/image-cache/venv/lib/python3.11/site-packages/starlette/routing.py", line 746, in __call__
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x1039f5080>
          │     │      │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x10379f9d0>>
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 7001), 'cl...
          │     └ <function Route.handle at 0x1026d8720>
          └ APIRoute(path='/{path:path}', name='redirect_to_cache', methods=['GET'])
  File "/Users/petrvolnov/work/HERE/image-cache/venv/lib/python3.11/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x1039f5080>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x10379f9d0>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 7001), 'cl...
          │    └ <function request_response.<locals>.app at 0x1039879c0>
          └ APIRoute(path='/{path:path}', name='redirect_to_cache', methods=['GET'])
  File "/Users/petrvolnov/work/HERE/image-cache/venv/lib/python3.11/site-packages/starlette/routing.py", line 75, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
          │                            │    │        │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x1039f5080>
          │                            │    │        │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x10379f9d0>>
          │                            │    │        └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 7001), 'cl...
          │                            │    └ <starlette.requests.Request object at 0x10352c1d0>
          │                            └ <function request_response.<locals>.app.<locals>.app at 0x1039f5120>
          └ <function wrap_app_handling_exceptions at 0x1026b3060>
  File "/Users/petrvolnov/work/HERE/image-cache/venv/lib/python3.11/site-packages/starlette/_exception_handler.py", line 44, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x1039f5260>
          │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x10379f9d0>>
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 7001), 'cl...
          └ <function request_response.<locals>.app.<locals>.app at 0x1039f5120>
  File "/Users/petrvolnov/work/HERE/image-cache/venv/lib/python3.11/site-packages/starlette/routing.py", line 70, in app
    response = await func(request)
                     │    └ <starlette.requests.Request object at 0x10352c1d0>
                     └ <function get_request_handler.<locals>.app at 0x103987380>
  File "/Users/petrvolnov/work/HERE/image-cache/venv/lib/python3.11/site-packages/fastapi/routing.py", line 294, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x1026b2700>
  File "/Users/petrvolnov/work/HERE/image-cache/venv/lib/python3.11/site-packages/fastapi/routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'path': 'favicon.ico', 'sz': None, 'r': <starlette.requests.Request object at 0x10352c1d0>}
                 │         └ <function redirect_to_cache at 0x103964720>
                 └ <fastapi.dependencies.models.Dependant object at 0x1039996d0>

> File "/Users/petrvolnov/work/HERE/image-cache/src/routes.py", line 138, in redirect_to_cache
    async with session.get(f"https://{url_path}") as response:
               │       └ <function ClientSession.get at 0x102d15800>
               └ <aiohttp.client.ClientSession object at 0x103a00a90>

  File "/Users/petrvolnov/work/HERE/image-cache/venv/lib/python3.11/site-packages/aiohttp/client.py", line 1187, in __aenter__
    self._resp = await self._coro
    │    │             │    └ <member '_coro' of '_BaseRequestContextManager' objects>
    │    │             └ <aiohttp.client._RequestContextManager object at 0x1039e5f60>
    │    └ <member '_resp' of '_BaseRequestContextManager' objects>
    └ <aiohttp.client._RequestContextManager object at 0x1039e5f60>
  File "/Users/petrvolnov/work/HERE/image-cache/venv/lib/python3.11/site-packages/aiohttp/client.py", line 574, in _request
    conn = await self._connector.connect(
                 │    │          └ <function BaseConnector.connect at 0x102c4c2c0>
                 │    └ <aiohttp.connector.TCPConnector object at 0x103595350>
                 └ <aiohttp.client.ClientSession object at 0x103a00a90>
  File "/Users/petrvolnov/work/HERE/image-cache/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 544, in connect
    proto = await self._create_connection(req, traces, timeout)
                  │    │                  │    │       └ ClientTimeout(total=300, connect=None, sock_read=None, sock_connect=None, ceil_threshold=5)
                  │    │                  │    └ []
                  │    │                  └ <aiohttp.client_reqrep.ClientRequest object at 0x1037c4450>
                  │    └ <function TCPConnector._create_connection at 0x102c4cea0>
                  └ <aiohttp.connector.TCPConnector object at 0x103595350>
  File "/Users/petrvolnov/work/HERE/image-cache/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 911, in _create_connection
    _, proto = await self._create_direct_connection(req, traces, timeout)
                     │    │                         │    │       └ ClientTimeout(total=300, connect=None, sock_read=None, sock_connect=None, ceil_threshold=5)
                     │    │                         │    └ []
                     │    │                         └ <aiohttp.client_reqrep.ClientRequest object at 0x1037c4450>
                     │    └ <function TCPConnector._create_direct_connection at 0x102c4d580>
                     └ <aiohttp.connector.TCPConnector object at 0x103595350>
  File "/Users/petrvolnov/work/HERE/image-cache/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1187, in _create_direct_connection
    raise ClientConnectorError(req.connection_key, exc) from exc
          │                    │   └ <property object at 0x102c21080>
          │                    └ <aiohttp.client_reqrep.ClientRequest object at 0x1037c4450>
          └ <class 'aiohttp.client_exceptions.ClientConnectorError'>

aiohttp.client_exceptions.ClientConnectorError: Cannot connect to host favicon.ico:443 ssl:default [nodename nor servname provided, or not known]
2024-01-02 21:26:47.324 | ERROR    | routes:redirect_to_cache:153 - Cannot connect to host favicon.ico:443 ssl:default [nodename nor servname provided, or not known] favicon.ico
2024-01-02 21:27:14.312 | ERROR    | routes:redirect_to_cache:152 - Cannot connect to host favicon.ico:443 ssl:default [nodename nor servname provided, or not known]
Traceback (most recent call last):

  File "/Users/petrvolnov/work/HERE/image-cache/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1173, in _create_direct_connection
    hosts = await asyncio.shield(host_resolved)
                  │       │      └ <Task finished name='Task-7' coro=<TCPConnector._resolve_host() done, defined at /Users/petrvolnov/work/HERE/image-cache/venv...
                  │       └ <function shield at 0x103ae0fe0>
                  └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.11/3.11.6_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/as...
  File "/Users/petrvolnov/work/HERE/image-cache/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 884, in _resolve_host
    addrs = await self._resolver.resolve(host, port, family=self._family)
                  │    │         │       │     │            │    └ 0
                  │    │         │       │     │            └ <aiohttp.connector.TCPConnector object at 0x105fc5350>
                  │    │         │       │     └ 443
                  │    │         │       └ 'favicon.ico'
                  │    │         └ <function ThreadedResolver.resolve at 0x1054f6ac0>
                  │    └ <aiohttp.resolver.ThreadedResolver object at 0x1062f5910>
                  └ <aiohttp.connector.TCPConnector object at 0x105fc5350>
  File "/Users/petrvolnov/work/HERE/image-cache/venv/lib/python3.11/site-packages/aiohttp/resolver.py", line 33, in resolve
    infos = await self._loop.getaddrinfo(
                  │    │     └ <function BaseEventLoop.getaddrinfo at 0x103aee5c0>
                  │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
                  └ <aiohttp.resolver.ThreadedResolver object at 0x1062f5910>

  File "/opt/homebrew/Cellar/python@3.11/3.11.6_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 867, in getaddrinfo
    return await self.run_in_executor(
                 │    └ <function BaseEventLoop.run_in_executor at 0x103aee3e0>
                 └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.6_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
             │        │            └ None
             │        └ None
             └ None

  File "/opt/homebrew/Cellar/python@3.11/3.11.6_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/socket.py", line 962, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
               │       │           │     │     │       │     │      └ <AddressInfo.AI_ADDRCONFIG: 1024>
               │       │           │     │     │       │     └ 0
               │       │           │     │     │       └ <SocketKind.SOCK_STREAM: 1>
               │       │           │     │     └ 0
               │       │           │     └ 443
               │       │           └ 'favicon.ico'
               │       └ <built-in function getaddrinfo>
               └ <module '_socket' from '/opt/homebrew/Cellar/python@3.11/3.11.6_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/li...

socket.gaierror: [Errno 8] nodename nor servname provided, or not known


The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "/Users/petrvolnov/work/HERE/image-cache/src/run_web.py", line 73, in <module>
    uvicorn.run(
    │       └ <function run at 0x103d52200>
    └ <module 'uvicorn' from '/Users/petrvolnov/work/HERE/image-cache/venv/lib/python3.11/site-packages/uvicorn/__init__.py'>

  File "/Users/petrvolnov/work/HERE/image-cache/venv/lib/python3.11/site-packages/uvicorn/main.py", line 587, in run
    server.run()
    │      └ <function Server.run at 0x103d93920>
    └ <uvicorn.server.Server object at 0x103d2eb90>
  File "/Users/petrvolnov/work/HERE/image-cache/venv/lib/python3.11/site-packages/uvicorn/server.py", line 61, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ None
           │       │   │    └ <function Server.serve at 0x103d939c0>
           │       │   └ <uvicorn.server.Server object at 0x103d2eb90>
           │       └ <function run at 0x103a90540>
           └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.11/3.11.6_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/as...

  File "/opt/homebrew/Cellar/python@3.11/3.11.6_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           │      │   └ <coroutine object Server.serve at 0x10649b340>
           │      └ <function Runner.run at 0x103aefec0>
           └ <asyncio.runners.Runner object at 0x105f4bb10>

  File "/opt/homebrew/Cellar/python@3.11/3.11.6_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<Server.serve() running at /Users/petrvolnov/work/HERE/image-cache/venv/lib/python3.11/site-...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x103aedb20>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x105f4bb10>

  File "/opt/homebrew/Cellar/python@3.11/3.11.6_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x103aeda80>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.6_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x103aef880>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.6_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1922, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x103a2dd00>
    └ <Handle Task.task_wakeup(<Future finis...r not known')>)>

  File "/opt/homebrew/Cellar/python@3.11/3.11.6_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finis...r not known')>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finis...r not known')>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finis...r not known')>)>

  File "/Users/petrvolnov/work/HERE/image-cache/venv/lib/python3.11/site-packages/uvicorn/protocols/http/h11_impl.py", line 408, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x105f4bad0>
  File "/Users/petrvolnov/work/HERE/image-cache/venv/lib/python3.11/site-packages/uvicorn/middleware/proxy_headers.py", line 84, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x106530cd0>>
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x106530cd0>>
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 7001), 'cl...
                 │    └ <fastapi.applications.FastAPI object at 0x1064c8590>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x105f4bad0>
  File "/Users/petrvolnov/work/HERE/image-cache/venv/lib/python3.11/site-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x106530cd0>>
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x106530cd0>>
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 7001), 'cl...
  File "/Users/petrvolnov/work/HERE/image-cache/venv/lib/python3.11/site-packages/starlette/applications.py", line 116, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x106530cd0>>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x106530cd0>>
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 7001), 'cl...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x1062e7150>
          └ <fastapi.applications.FastAPI object at 0x1064c8590>
  File "/Users/petrvolnov/work/HERE/image-cache/venv/lib/python3.11/site-packages/starlette/middleware/errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x106524ea0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x106530cd0>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 7001), 'cl...
          │    └ <starlette.middleware.cors.CORSMiddleware object at 0x1062f79d0>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x1062e7150>
  File "/Users/petrvolnov/work/HERE/image-cache/venv/lib/python3.11/site-packages/starlette/middleware/cors.py", line 83, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x106524ea0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x106530cd0>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 7001), 'cl...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x1064a0050>
          └ <starlette.middleware.cors.CORSMiddleware object at 0x1062f79d0>
  File "/Users/petrvolnov/work/HERE/image-cache/venv/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
          │                            │    │    │     │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x106524ea0>
          │                            │    │    │     │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x106530cd0>>
          │                            │    │    │     └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 7001), 'cl...
          │                            │    │    └ <starlette.requests.Request object at 0x106530bd0>
          │                            │    └ <fastapi.routing.APIRouter object at 0x1064c8690>
          │                            └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x1064a0050>
          └ <function wrap_app_handling_exceptions at 0x104f83060>
  File "/Users/petrvolnov/work/HERE/image-cache/venv/lib/python3.11/site-packages/starlette/_exception_handler.py", line 44, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x106525080>
          │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x106530cd0>>
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 7001), 'cl...
          └ <fastapi.routing.APIRouter object at 0x1064c8690>
  File "/Users/petrvolnov/work/HERE/image-cache/venv/lib/python3.11/site-packages/starlette/routing.py", line 746, in __call__
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x106525080>
          │     │      │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x106530cd0>>
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 7001), 'cl...
          │     └ <function Route.handle at 0x104fa8720>
          └ APIRoute(path='/{path:path}', name='redirect_to_cache', methods=['GET'])
  File "/Users/petrvolnov/work/HERE/image-cache/venv/lib/python3.11/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x106525080>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x106530cd0>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 7001), 'cl...
          │    └ <function request_response.<locals>.app at 0x1064b79c0>
          └ APIRoute(path='/{path:path}', name='redirect_to_cache', methods=['GET'])
  File "/Users/petrvolnov/work/HERE/image-cache/venv/lib/python3.11/site-packages/starlette/routing.py", line 75, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
          │                            │    │        │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x106525080>
          │                            │    │        │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x106530cd0>>
          │                            │    │        └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 7001), 'cl...
          │                            │    └ <starlette.requests.Request object at 0x106530d50>
          │                            └ <function request_response.<locals>.app.<locals>.app at 0x106525120>
          └ <function wrap_app_handling_exceptions at 0x104f83060>
  File "/Users/petrvolnov/work/HERE/image-cache/venv/lib/python3.11/site-packages/starlette/_exception_handler.py", line 44, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x106525260>
          │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x106530cd0>>
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 7001), 'cl...
          └ <function request_response.<locals>.app.<locals>.app at 0x106525120>
  File "/Users/petrvolnov/work/HERE/image-cache/venv/lib/python3.11/site-packages/starlette/routing.py", line 70, in app
    response = await func(request)
                     │    └ <starlette.requests.Request object at 0x106530d50>
                     └ <function get_request_handler.<locals>.app at 0x1064b7380>
  File "/Users/petrvolnov/work/HERE/image-cache/venv/lib/python3.11/site-packages/fastapi/routing.py", line 294, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x104f82700>
  File "/Users/petrvolnov/work/HERE/image-cache/venv/lib/python3.11/site-packages/fastapi/routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'path': 'favicon.ico', 'sz': None, 'r': <starlette.requests.Request object at 0x106530d50>}
                 │         └ <function redirect_to_cache at 0x106494720>
                 └ <fastapi.dependencies.models.Dependant object at 0x1064c99d0>

> File "/Users/petrvolnov/work/HERE/image-cache/src/routes.py", line 138, in redirect_to_cache
    async with session.get(f"https://{url_path}") as response:
               │       └ <function ClientSession.get at 0x1055e5800>
               └ <aiohttp.client.ClientSession object at 0x106530f90>

  File "/Users/petrvolnov/work/HERE/image-cache/venv/lib/python3.11/site-packages/aiohttp/client.py", line 1187, in __aenter__
    self._resp = await self._coro
    │    │             │    └ <member '_coro' of '_BaseRequestContextManager' objects>
    │    │             └ <aiohttp.client._RequestContextManager object at 0x106515f90>
    │    └ <member '_resp' of '_BaseRequestContextManager' objects>
    └ <aiohttp.client._RequestContextManager object at 0x106515f90>
  File "/Users/petrvolnov/work/HERE/image-cache/venv/lib/python3.11/site-packages/aiohttp/client.py", line 574, in _request
    conn = await self._connector.connect(
                 │    │          └ <function BaseConnector.connect at 0x10551c2c0>
                 │    └ <aiohttp.connector.TCPConnector object at 0x105fc5350>
                 └ <aiohttp.client.ClientSession object at 0x106530f90>
  File "/Users/petrvolnov/work/HERE/image-cache/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 544, in connect
    proto = await self._create_connection(req, traces, timeout)
                  │    │                  │    │       └ ClientTimeout(total=300, connect=None, sock_read=None, sock_connect=None, ceil_threshold=5)
                  │    │                  │    └ []
                  │    │                  └ <aiohttp.client_reqrep.ClientRequest object at 0x1062f4450>
                  │    └ <function TCPConnector._create_connection at 0x10551cea0>
                  └ <aiohttp.connector.TCPConnector object at 0x105fc5350>
  File "/Users/petrvolnov/work/HERE/image-cache/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 911, in _create_connection
    _, proto = await self._create_direct_connection(req, traces, timeout)
                     │    │                         │    │       └ ClientTimeout(total=300, connect=None, sock_read=None, sock_connect=None, ceil_threshold=5)
                     │    │                         │    └ []
                     │    │                         └ <aiohttp.client_reqrep.ClientRequest object at 0x1062f4450>
                     │    └ <function TCPConnector._create_direct_connection at 0x10551d580>
                     └ <aiohttp.connector.TCPConnector object at 0x105fc5350>
  File "/Users/petrvolnov/work/HERE/image-cache/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1187, in _create_direct_connection
    raise ClientConnectorError(req.connection_key, exc) from exc
          │                    │   └ <property object at 0x1054f1080>
          │                    └ <aiohttp.client_reqrep.ClientRequest object at 0x1062f4450>
          └ <class 'aiohttp.client_exceptions.ClientConnectorError'>

aiohttp.client_exceptions.ClientConnectorError: Cannot connect to host favicon.ico:443 ssl:default [nodename nor servname provided, or not known]
2024-01-02 21:27:14.340 | ERROR    | routes:redirect_to_cache:153 - Cannot connect to host favicon.ico:443 ssl:default [nodename nor servname provided, or not known] favicon.ico
2024-01-02 21:30:26.410 | ERROR    | routes:redirect_to_cache:151 - Cannot connect to host favicon.ico:443 ssl:default [nodename nor servname provided, or not known]
Traceback (most recent call last):

  File "/Users/petrvolnov/work/HERE/image-cache/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1173, in _create_direct_connection
    hosts = await asyncio.shield(host_resolved)
                  │       │      └ <Task finished name='Task-7' coro=<TCPConnector._resolve_host() done, defined at /Users/petrvolnov/work/HERE/image-cache/venv...
                  │       └ <function shield at 0x1053ccfe0>
                  └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.11/3.11.6_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/as...
  File "/Users/petrvolnov/work/HERE/image-cache/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 884, in _resolve_host
    addrs = await self._resolver.resolve(host, port, family=self._family)
                  │    │         │       │     │            │    └ 0
                  │    │         │       │     │            └ <aiohttp.connector.TCPConnector object at 0x110a57350>
                  │    │         │       │     └ 443
                  │    │         │       └ 'favicon.ico'
                  │    │         └ <function ThreadedResolver.resolve at 0x107af44a0>
                  │    └ <aiohttp.resolver.ThreadedResolver object at 0x1109ee650>
                  └ <aiohttp.connector.TCPConnector object at 0x110a57350>
  File "/Users/petrvolnov/work/HERE/image-cache/venv/lib/python3.11/site-packages/aiohttp/resolver.py", line 33, in resolve
    infos = await self._loop.getaddrinfo(
                  │    │     └ <function BaseEventLoop.getaddrinfo at 0x1053da5c0>
                  │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
                  └ <aiohttp.resolver.ThreadedResolver object at 0x1109ee650>

  File "/opt/homebrew/Cellar/python@3.11/3.11.6_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 867, in getaddrinfo
    return await self.run_in_executor(
                 │    └ <function BaseEventLoop.run_in_executor at 0x1053da3e0>
                 └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.6_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
             │        │            └ None
             │        └ None
             └ None

  File "/opt/homebrew/Cellar/python@3.11/3.11.6_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/socket.py", line 962, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
               │       │           │     │     │       │     │      └ <AddressInfo.AI_ADDRCONFIG: 1024>
               │       │           │     │     │       │     └ 0
               │       │           │     │     │       └ <SocketKind.SOCK_STREAM: 1>
               │       │           │     │     └ 0
               │       │           │     └ 443
               │       │           └ 'favicon.ico'
               │       └ <built-in function getaddrinfo>
               └ <module '_socket' from '/opt/homebrew/Cellar/python@3.11/3.11.6_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/li...

socket.gaierror: [Errno 8] nodename nor servname provided, or not known


The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "/Users/petrvolnov/work/HERE/image-cache/src/run_web.py", line 73, in <module>
    uvicorn.run(
    │       └ <function run at 0x10563e200>
    └ <module 'uvicorn' from '/Users/petrvolnov/work/HERE/image-cache/venv/lib/python3.11/site-packages/uvicorn/__init__.py'>

  File "/Users/petrvolnov/work/HERE/image-cache/venv/lib/python3.11/site-packages/uvicorn/main.py", line 587, in run
    server.run()
    │      └ <function Server.run at 0x10567f920>
    └ <uvicorn.server.Server object at 0x10561ab10>
  File "/Users/petrvolnov/work/HERE/image-cache/venv/lib/python3.11/site-packages/uvicorn/server.py", line 61, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ None
           │       │   │    └ <function Server.serve at 0x10567f9c0>
           │       │   └ <uvicorn.server.Server object at 0x10561ab10>
           │       └ <function run at 0x10537c540>
           └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.11/3.11.6_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/as...

  File "/opt/homebrew/Cellar/python@3.11/3.11.6_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           │      │   └ <coroutine object Server.serve at 0x110a08150>
           │      └ <function Runner.run at 0x1053dbec0>
           └ <asyncio.runners.Runner object at 0x1106a3dd0>

  File "/opt/homebrew/Cellar/python@3.11/3.11.6_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<Server.serve() running at /Users/petrvolnov/work/HERE/image-cache/venv/lib/python3.11/site-...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x1053d9b20>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x1106a3dd0>

  File "/opt/homebrew/Cellar/python@3.11/3.11.6_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x1053d9a80>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.6_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x1053db880>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.6_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1922, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x105319d00>
    └ <Handle Task.task_wakeup(<Future finis...r not known')>)>

  File "/opt/homebrew/Cellar/python@3.11/3.11.6_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finis...r not known')>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finis...r not known')>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finis...r not known')>)>

  File "/Users/petrvolnov/work/HERE/image-cache/venv/lib/python3.11/site-packages/uvicorn/protocols/http/h11_impl.py", line 408, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x110473e50>
  File "/Users/petrvolnov/work/HERE/image-cache/venv/lib/python3.11/site-packages/uvicorn/middleware/proxy_headers.py", line 84, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x1103dd2d0>>
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x1103dd2d0>>
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 7001), 'cl...
                 │    └ <fastapi.applications.FastAPI object at 0x1109ed950>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x110473e50>
  File "/Users/petrvolnov/work/HERE/image-cache/venv/lib/python3.11/site-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x1103dd2d0>>
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x1103dd2d0>>
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 7001), 'cl...
  File "/Users/petrvolnov/work/HERE/image-cache/venv/lib/python3.11/site-packages/starlette/applications.py", line 116, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x1103dd2d0>>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x1103dd2d0>>
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 7001), 'cl...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x1106bcf10>
          └ <fastapi.applications.FastAPI object at 0x1109ed950>
  File "/Users/petrvolnov/work/HERE/image-cache/venv/lib/python3.11/site-packages/starlette/middleware/errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x110a4ea20>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x1103dd2d0>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 7001), 'cl...
          │    └ <starlette.middleware.cors.CORSMiddleware object at 0x1106bd010>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x1106bcf10>
  File "/Users/petrvolnov/work/HERE/image-cache/venv/lib/python3.11/site-packages/starlette/middleware/cors.py", line 83, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x110a4ea20>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x1103dd2d0>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 7001), 'cl...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x1106be2d0>
          └ <starlette.middleware.cors.CORSMiddleware object at 0x1106bd010>
  File "/Users/petrvolnov/work/HERE/image-cache/venv/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
          │                            │    │    │     │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x110a4ea20>
          │                            │    │    │     │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x1103dd2d0>>
          │                            │    │    │     └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 7001), 'cl...
          │                            │    │    └ <starlette.requests.Request object at 0x110a56f50>
          │                            │    └ <fastapi.routing.APIRouter object at 0x1109edb90>
          │                            └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x1106be2d0>
          └ <function wrap_app_handling_exceptions at 0x10686f060>
  File "/Users/petrvolnov/work/HERE/image-cache/venv/lib/python3.11/site-packages/starlette/_exception_handler.py", line 44, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x110a4eb60>
          │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x1103dd2d0>>
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 7001), 'cl...
          └ <fastapi.routing.APIRouter object at 0x1109edb90>
  File "/Users/petrvolnov/work/HERE/image-cache/venv/lib/python3.11/site-packages/starlette/routing.py", line 746, in __call__
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x110a4eb60>
          │     │      │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x1103dd2d0>>
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 7001), 'cl...
          │     └ <function Route.handle at 0x106890720>
          └ APIRoute(path='/{path:path}', name='redirect_to_cache', methods=['GET'])
  File "/Users/petrvolnov/work/HERE/image-cache/venv/lib/python3.11/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x110a4eb60>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x1103dd2d0>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 7001), 'cl...
          │    └ <function request_response.<locals>.app at 0x1109f65c0>
          └ APIRoute(path='/{path:path}', name='redirect_to_cache', methods=['GET'])
  File "/Users/petrvolnov/work/HERE/image-cache/venv/lib/python3.11/site-packages/starlette/routing.py", line 75, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
          │                            │    │        │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x110a4eb60>
          │                            │    │        │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x1103dd2d0>>
          │                            │    │        └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 7001), 'cl...
          │                            │    └ <starlette.requests.Request object at 0x110a57110>
          │                            └ <function request_response.<locals>.app.<locals>.app at 0x110a4ec00>
          └ <function wrap_app_handling_exceptions at 0x10686f060>
  File "/Users/petrvolnov/work/HERE/image-cache/venv/lib/python3.11/site-packages/starlette/_exception_handler.py", line 44, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x110a4ed40>
          │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x1103dd2d0>>
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 7001), 'cl...
          └ <function request_response.<locals>.app.<locals>.app at 0x110a4ec00>
  File "/Users/petrvolnov/work/HERE/image-cache/venv/lib/python3.11/site-packages/starlette/routing.py", line 70, in app
    response = await func(request)
                     │    └ <starlette.requests.Request object at 0x110a57110>
                     └ <function get_request_handler.<locals>.app at 0x1109f6700>
  File "/Users/petrvolnov/work/HERE/image-cache/venv/lib/python3.11/site-packages/fastapi/routing.py", line 294, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x10686e700>
  File "/Users/petrvolnov/work/HERE/image-cache/venv/lib/python3.11/site-packages/fastapi/routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'path': 'favicon.ico', 'sz': None, 'r': <starlette.requests.Request object at 0x110a57110>}
                 │         └ <function redirect_to_cache at 0x1109c34c0>
                 └ <fastapi.dependencies.models.Dependant object at 0x1109fca90>

> File "/Users/petrvolnov/work/HERE/image-cache/src/routes.py", line 137, in redirect_to_cache
    async with session.get(f"https://{url_path}") as response:
               │       └ <function ClientSession.get at 0x107b4f1a0>
               └ <aiohttp.client.ClientSession object at 0x110a572d0>

  File "/Users/petrvolnov/work/HERE/image-cache/venv/lib/python3.11/site-packages/aiohttp/client.py", line 1187, in __aenter__
    self._resp = await self._coro
    │    │             │    └ <member '_coro' of '_BaseRequestContextManager' objects>
    │    │             └ <aiohttp.client._RequestContextManager object at 0x110a33760>
    │    └ <member '_resp' of '_BaseRequestContextManager' objects>
    └ <aiohttp.client._RequestContextManager object at 0x110a33760>
  File "/Users/petrvolnov/work/HERE/image-cache/venv/lib/python3.11/site-packages/aiohttp/client.py", line 574, in _request
    conn = await self._connector.connect(
                 │    │          └ <function BaseConnector.connect at 0x107af5c60>
                 │    └ <aiohttp.connector.TCPConnector object at 0x110a57350>
                 └ <aiohttp.client.ClientSession object at 0x110a572d0>
  File "/Users/petrvolnov/work/HERE/image-cache/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 544, in connect
    proto = await self._create_connection(req, traces, timeout)
                  │    │                  │    │       └ ClientTimeout(total=300, connect=None, sock_read=None, sock_connect=None, ceil_threshold=5)
                  │    │                  │    └ []
                  │    │                  └ <aiohttp.client_reqrep.ClientRequest object at 0x1106a1290>
                  │    └ <function TCPConnector._create_connection at 0x107af6840>
                  └ <aiohttp.connector.TCPConnector object at 0x110a57350>
  File "/Users/petrvolnov/work/HERE/image-cache/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 911, in _create_connection
    _, proto = await self._create_direct_connection(req, traces, timeout)
                     │    │                         │    │       └ ClientTimeout(total=300, connect=None, sock_read=None, sock_connect=None, ceil_threshold=5)
                     │    │                         │    └ []
                     │    │                         └ <aiohttp.client_reqrep.ClientRequest object at 0x1106a1290>
                     │    └ <function TCPConnector._create_direct_connection at 0x107af6f20>
                     └ <aiohttp.connector.TCPConnector object at 0x110a57350>
  File "/Users/petrvolnov/work/HERE/image-cache/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1187, in _create_direct_connection
    raise ClientConnectorError(req.connection_key, exc) from exc
          │                    │   └ <property object at 0x107ac0cc0>
          │                    └ <aiohttp.client_reqrep.ClientRequest object at 0x1106a1290>
          └ <class 'aiohttp.client_exceptions.ClientConnectorError'>

aiohttp.client_exceptions.ClientConnectorError: Cannot connect to host favicon.ico:443 ssl:default [nodename nor servname provided, or not known]
2024-01-02 21:30:26.442 | ERROR    | routes:redirect_to_cache:152 - Cannot connect to host favicon.ico:443 ssl:default [nodename nor servname provided, or not known] favicon.ico
2024-01-02 21:38:48.266 | ERROR    | routes:redirect_to_cache:151 - Cannot connect to host favicon.ico:443 ssl:default [nodename nor servname provided, or not known]
Traceback (most recent call last):

  File "/Users/petrvolnov/work/HERE/image-cache/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1173, in _create_direct_connection
    hosts = await asyncio.shield(host_resolved)
                  │       │      └ <Task finished name='Task-7' coro=<TCPConnector._resolve_host() done, defined at /Users/petrvolnov/work/HERE/image-cache/venv...
                  │       └ <function shield at 0x1032ecfe0>
                  └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.11/3.11.6_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/as...
  File "/Users/petrvolnov/work/HERE/image-cache/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 884, in _resolve_host
    addrs = await self._resolver.resolve(host, port, family=self._family)
                  │    │         │       │     │            │    └ 0
                  │    │         │       │     │            └ <aiohttp.connector.TCPConnector object at 0x1078d3150>
                  │    │         │       │     └ 443
                  │    │         │       └ 'favicon.ico'
                  │    │         └ <function ThreadedResolver.resolve at 0x1068f44a0>
                  │    └ <aiohttp.resolver.ThreadedResolver object at 0x10780afd0>
                  └ <aiohttp.connector.TCPConnector object at 0x1078d3150>
  File "/Users/petrvolnov/work/HERE/image-cache/venv/lib/python3.11/site-packages/aiohttp/resolver.py", line 33, in resolve
    infos = await self._loop.getaddrinfo(
                  │    │     └ <function BaseEventLoop.getaddrinfo at 0x1032fa5c0>
                  │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
                  └ <aiohttp.resolver.ThreadedResolver object at 0x10780afd0>

  File "/opt/homebrew/Cellar/python@3.11/3.11.6_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 867, in getaddrinfo
    return await self.run_in_executor(
                 │    └ <function BaseEventLoop.run_in_executor at 0x1032fa3e0>
                 └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.6_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
             │        │            └ None
             │        └ None
             └ None

  File "/opt/homebrew/Cellar/python@3.11/3.11.6_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/socket.py", line 962, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
               │       │           │     │     │       │     │      └ <AddressInfo.AI_ADDRCONFIG: 1024>
               │       │           │     │     │       │     └ 0
               │       │           │     │     │       └ <SocketKind.SOCK_STREAM: 1>
               │       │           │     │     └ 0
               │       │           │     └ 443
               │       │           └ 'favicon.ico'
               │       └ <built-in function getaddrinfo>
               └ <module '_socket' from '/opt/homebrew/Cellar/python@3.11/3.11.6_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/li...

socket.gaierror: [Errno 8] nodename nor servname provided, or not known


The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "/Users/petrvolnov/work/HERE/image-cache/src/run_web.py", line 73, in <module>
    uvicorn.run(
    │       └ <function run at 0x10355e200>
    └ <module 'uvicorn' from '/Users/petrvolnov/work/HERE/image-cache/venv/lib/python3.11/site-packages/uvicorn/__init__.py'>

  File "/Users/petrvolnov/work/HERE/image-cache/venv/lib/python3.11/site-packages/uvicorn/main.py", line 587, in run
    server.run()
    │      └ <function Server.run at 0x10359f920>
    └ <uvicorn.server.Server object at 0x10783c210>
  File "/Users/petrvolnov/work/HERE/image-cache/venv/lib/python3.11/site-packages/uvicorn/server.py", line 61, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ None
           │       │   │    └ <function Server.serve at 0x10359f9c0>
           │       │   └ <uvicorn.server.Server object at 0x10783c210>
           │       └ <function run at 0x10329c540>
           └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.11/3.11.6_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/as...

  File "/opt/homebrew/Cellar/python@3.11/3.11.6_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           │      │   └ <coroutine object Server.serve at 0x107b08150>
           │      └ <function Runner.run at 0x1032fbec0>
           └ <asyncio.runners.Runner object at 0x107883dd0>

  File "/opt/homebrew/Cellar/python@3.11/3.11.6_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<Server.serve() running at /Users/petrvolnov/work/HERE/image-cache/venv/lib/python3.11/site-...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x1032f9b20>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x107883dd0>

  File "/opt/homebrew/Cellar/python@3.11/3.11.6_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x1032f9a80>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.6_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x1032fb880>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.6_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1922, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x103239d00>
    └ <Handle Task.task_wakeup(<Future finis...r not known')>)>

  File "/opt/homebrew/Cellar/python@3.11/3.11.6_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finis...r not known')>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finis...r not known')>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finis...r not known')>)>

  File "/Users/petrvolnov/work/HERE/image-cache/venv/lib/python3.11/site-packages/uvicorn/protocols/http/h11_impl.py", line 408, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x1077f06d0>
  File "/Users/petrvolnov/work/HERE/image-cache/venv/lib/python3.11/site-packages/uvicorn/middleware/proxy_headers.py", line 84, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x107808090>>
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x107808090>>
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 7001), 'cl...
                 │    └ <fastapi.applications.FastAPI object at 0x1079ee5d0>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x1077f06d0>
  File "/Users/petrvolnov/work/HERE/image-cache/venv/lib/python3.11/site-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x107808090>>
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x107808090>>
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 7001), 'cl...
  File "/Users/petrvolnov/work/HERE/image-cache/venv/lib/python3.11/site-packages/starlette/applications.py", line 116, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x107808090>>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x107808090>>
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 7001), 'cl...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x1079bb350>
          └ <fastapi.applications.FastAPI object at 0x1079ee5d0>
  File "/Users/petrvolnov/work/HERE/image-cache/venv/lib/python3.11/site-packages/starlette/middleware/errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x107b52b60>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x107808090>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 7001), 'cl...
          │    └ <starlette.middleware.cors.CORSMiddleware object at 0x107825e50>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x1079bb350>
  File "/Users/petrvolnov/work/HERE/image-cache/venv/lib/python3.11/site-packages/starlette/middleware/cors.py", line 83, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x107b52b60>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x107808090>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 7001), 'cl...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x10755cc50>
          └ <starlette.middleware.cors.CORSMiddleware object at 0x107825e50>
  File "/Users/petrvolnov/work/HERE/image-cache/venv/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
          │                            │    │    │     │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x107b52b60>
          │                            │    │    │     │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x107808090>>
          │                            │    │    │     └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 7001), 'cl...
          │                            │    │    └ <starlette.requests.Request object at 0x1077f2610>
          │                            │    └ <fastapi.routing.APIRouter object at 0x1079ee6d0>
          │                            └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x10755cc50>
          └ <function wrap_app_handling_exceptions at 0x104d8f060>
  File "/Users/petrvolnov/work/HERE/image-cache/venv/lib/python3.11/site-packages/starlette/_exception_handler.py", line 44, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x107b52c00>
          │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x107808090>>
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 7001), 'cl...
          └ <fastapi.routing.APIRouter object at 0x1079ee6d0>
  File "/Users/petrvolnov/work/HERE/image-cache/venv/lib/python3.11/site-packages/starlette/routing.py", line 746, in __call__
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x107b52c00>
          │     │      │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x107808090>>
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 7001), 'cl...
          │     └ <function Route.handle at 0x104db4720>
          └ APIRoute(path='/{path:path}', name='redirect_to_cache', methods=['GET'])
  File "/Users/petrvolnov/work/HERE/image-cache/venv/lib/python3.11/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x107b52c00>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x107808090>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 7001), 'cl...
          │    └ <function request_response.<locals>.app at 0x1079f65c0>
          └ APIRoute(path='/{path:path}', name='redirect_to_cache', methods=['GET'])
  File "/Users/petrvolnov/work/HERE/image-cache/venv/lib/python3.11/site-packages/starlette/routing.py", line 75, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
          │                            │    │        │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x107b52c00>
          │                            │    │        │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x107808090>>
          │                            │    │        └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 7001), 'cl...
          │                            │    └ <starlette.requests.Request object at 0x1077f2e10>
          │                            └ <function request_response.<locals>.app.<locals>.app at 0x107b52ca0>
          └ <function wrap_app_handling_exceptions at 0x104d8f060>
  File "/Users/petrvolnov/work/HERE/image-cache/venv/lib/python3.11/site-packages/starlette/_exception_handler.py", line 44, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x107b52de0>
          │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x107808090>>
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 7001), 'cl...
          └ <function request_response.<locals>.app.<locals>.app at 0x107b52ca0>
  File "/Users/petrvolnov/work/HERE/image-cache/venv/lib/python3.11/site-packages/starlette/routing.py", line 70, in app
    response = await func(request)
                     │    └ <starlette.requests.Request object at 0x1077f2e10>
                     └ <function get_request_handler.<locals>.app at 0x1079f6700>
  File "/Users/petrvolnov/work/HERE/image-cache/venv/lib/python3.11/site-packages/fastapi/routing.py", line 294, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x104d8e700>
  File "/Users/petrvolnov/work/HERE/image-cache/venv/lib/python3.11/site-packages/fastapi/routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'path': 'favicon.ico', 'sz': None, 'r': <starlette.requests.Request object at 0x1077f2e10>}
                 │         └ <function redirect_to_cache at 0x1079c34c0>
                 └ <fastapi.dependencies.models.Dependant object at 0x1079fd810>

> File "/Users/petrvolnov/work/HERE/image-cache/src/routes.py", line 137, in redirect_to_cache
    async with session.get(f"https://{url_path}") as response:
               │       └ <function ClientSession.get at 0x106af71a0>
               └ <aiohttp.client.ClientSession object at 0x107b4b890>

  File "/Users/petrvolnov/work/HERE/image-cache/venv/lib/python3.11/site-packages/aiohttp/client.py", line 1187, in __aenter__
    self._resp = await self._coro
    │    │             │    └ <member '_coro' of '_BaseRequestContextManager' objects>
    │    │             └ <aiohttp.client._RequestContextManager object at 0x107b33730>
    │    └ <member '_resp' of '_BaseRequestContextManager' objects>
    └ <aiohttp.client._RequestContextManager object at 0x107b33730>
  File "/Users/petrvolnov/work/HERE/image-cache/venv/lib/python3.11/site-packages/aiohttp/client.py", line 574, in _request
    conn = await self._connector.connect(
                 │    │          └ <function BaseConnector.connect at 0x1068f5c60>
                 │    └ <aiohttp.connector.TCPConnector object at 0x1078d3150>
                 └ <aiohttp.client.ClientSession object at 0x107b4b890>
  File "/Users/petrvolnov/work/HERE/image-cache/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 544, in connect
    proto = await self._create_connection(req, traces, timeout)
                  │    │                  │    │       └ ClientTimeout(total=300, connect=None, sock_read=None, sock_connect=None, ceil_threshold=5)
                  │    │                  │    └ []
                  │    │                  └ <aiohttp.client_reqrep.ClientRequest object at 0x104a65010>
                  │    └ <function TCPConnector._create_connection at 0x1068f6840>
                  └ <aiohttp.connector.TCPConnector object at 0x1078d3150>
  File "/Users/petrvolnov/work/HERE/image-cache/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 911, in _create_connection
    _, proto = await self._create_direct_connection(req, traces, timeout)
                     │    │                         │    │       └ ClientTimeout(total=300, connect=None, sock_read=None, sock_connect=None, ceil_threshold=5)
                     │    │                         │    └ []
                     │    │                         └ <aiohttp.client_reqrep.ClientRequest object at 0x104a65010>
                     │    └ <function TCPConnector._create_direct_connection at 0x1068f6f20>
                     └ <aiohttp.connector.TCPConnector object at 0x1078d3150>
  File "/Users/petrvolnov/work/HERE/image-cache/venv/lib/python3.11/site-packages/aiohttp/connector.py", line 1187, in _create_direct_connection
    raise ClientConnectorError(req.connection_key, exc) from exc
          │                    │   └ <property object at 0x1068c0d10>
          │                    └ <aiohttp.client_reqrep.ClientRequest object at 0x104a65010>
          └ <class 'aiohttp.client_exceptions.ClientConnectorError'>

aiohttp.client_exceptions.ClientConnectorError: Cannot connect to host favicon.ico:443 ssl:default [nodename nor servname provided, or not known]
2024-01-02 21:38:48.301 | ERROR    | routes:redirect_to_cache:152 - Cannot connect to host favicon.ico:443 ssl:default [nodename nor servname provided, or not known] favicon.ico
